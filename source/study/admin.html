<link rel="stylesheet" href="./study.css" />
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
<script src="./study.js"></script>

<div class="app" id="app">
    <section class="admin-container">
        <h1 class="ta-c mb-50">我的汉字表</h1>
        <div class="admin m-auto">
            <ul class="word-list">
                <li v-for="(item, index) in wordList" :key="item.word" class="word-item flex-row">
                    <div class="sn flex0">${ index + 1 }</div>
                    <div class="word flex1">${ item.word }</div>
                    <div class="word flex1">${ item.date }</div>
                    <div><button class="op-btn" v-on:click="rmWord(index)">删除</button></div>
                </li>
            </ul>
            <div class="append-line flex-row mt-50">
                <input class="flex1" type="text" @keyup.enter="addWord" placeholder="新文字 回车确认添加" v-model="newWord">
                <button v-on:click="addWord" class="op-btn">添加</button>
                <button v-on:click="rmAllWords" class="op-btn danger">全部删除</button>

            </div>
        </div>
    </section>
</div>

<script>
    new Vue({
        el: '#app',
        delimiters: ['${', '}'],
        data: {
            showAdmin: false,
            showCard: true,
            newWord: '',
            wordList: LCache.get('words') || []
        },
        methods: {
            addWord() {
                if (this.newWord.trim()) {
                    const word = this.newWord.trim()
                    const exists = this.wordList.find(item => item.word === word)
                    if (exists) {
                        alert('该文字已存在')
                        return;
                    }
                    const today = getTodayStr()
                    this.wordList.push({date: today, word});
                    this.newWord = '';

                    LCache.set('words', this.wordList);
                }
            },
            rmWord(index) {
                this.wordList.splice(index, 1);
                LCache.set('words', this.wordList);
            },
            rmAllWords() {
                this.wordList = [];
                LCache.set('words', this.wordList);
            }
        }
    });
</script>
