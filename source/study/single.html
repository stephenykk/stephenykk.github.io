<link rel="stylesheet" href="./study.css" />
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
<script src="./study.js"></script>

<div :class="'app ' + (this.isMobile ? 'mobile' : '')" id="app">
    <h1 style="margin-bottom: 0">单字认读</h1>
    <div class="font-bar mb-20 ta-r">
        <button :class="fontType === 1 ? 'primary' : ''" @click="fontType = 1">字体1</button>
        <button :class="fontType === 2 ? 'primary' : ''" @click="fontType = 2">字体2</button>
        <button :class="fontType === 3 ? 'primary' : ''" @click="fontType = 3">字体3</button>
        <button :class="fontType === 4 ? 'primary' : ''" @click="fontType = 4">字体4</button>
        <button :class="fontType === 5 ? 'primary' : ''" @click="fontType = 5">字体5</button>
        <label>
            <input type="checkbox" v-model="isRandom" @change="changeRandom"></checkbox>
            <span>是否随机</span>
        </label>
    </div>
    <section class="app-main single-container">
        <button class="prev" @click="showPrev">&lt;</button>
        <button class="next" @click="showNext">&gt;</button>
        <div class="single m-auto">
            <ul class="card-list flex-row justify-center pos-r">
                <li v-for="(item, index) in wordList" :key="index" class="card-item-wrap">
                    <transition :name="isNext ? 'lfade' : 'rfade'">
                        <div class="card-item" v-show="index === activeIndex">
                            <div :class="'card-con flex1 font' + fontType">${ item.word }</div>
                        </div>
                    </transition>
                    
                </li>
            </ul>
            <p class="mt-30 ta-c">
                <i class="num f30">${activeIndex + 1}</i>

            </p>
        </div>
    </section>
</div>

<script>
    window.myapp = new Vue({
        el: "#app",
        delimiters: ["${", "}"],
        data: {
            activeIndex: 0,
            isNext: true,
            isMobile: window.innerWidth < 800,
            isRandom: false,
            showCard: true,
            fontType: LCache.get('fontType') || 2,
            newWord: "",
            wordList: LCache.get("words") || [],
        },
        watch: {
            fontType() {
                LCache.set('fontType', this.fontType)
            }
        },
        methods: {
            changeRandom(event) {
                if (this.isRandom) {
                    this.wordList = getShuffleList(this.wordList)
                } else {
                    this.wordList = this.orderedWordList;
                }
            },
            showNext() {
                this.isNext = true
                if (this.activeIndex < this.wordList.length - 1) {
                    this.activeIndex++;
                } else {
                    this.activeIndex = 0;
                }
            },
            showPrev() {
                this.isNext = false
                if (this.activeIndex > 0) {
                    this.activeIndex--;
                } else {
                    this.activeIndex = this.wordList.length - 1;
                }
            },
            addWord() {
                if (this.newWord.trim()) {
                    const today = getTodayStr();
                    const word = this.newWord.trim();
                    this.wordList.push({ date: today, word });
                    this.newWord = "";

                    LCache.set("words", this.wordList);
                }
            },
        },
        
        mounted() {
            if (!this.wordList.length) {
                alert('请先增加文字')
                location.href = '/study'
            }else {
                this.orderedWordList = this.wordList.slice()
            }
        }
    });
</script>
