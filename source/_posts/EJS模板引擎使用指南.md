---
title: EJS模板引擎使用指南
date: 2024-03-12 11:36:16
tags: 
    - 模板引擎
    - ejs
---


> 原文地址[EJS：高效的嵌入式 JavaScript 模板引擎 - 掘金](https://juejin.cn/post/7247342069617852453?searchId=202403121131487E0A807830A1ED228196)

EJS（Embedded JavaScript Templates）是一种简单而灵活的模板引擎，用于将数据动态渲染到网页上。本文将从介绍EJS的背景和起源开始，详细介绍EJS的特性和使用方法，包括安装配置、基本语法和标签、数据绑定和逻辑控制、模板的继承和包含等方面。然后，重点解析EJS的核心特性，包括嵌入JavaScript代码、支持变量、自定义过滤器和函数、条件判断和循环、模板的复用和组合。接着，给出了EJS的性能优化技巧，如缓存编译后的模板、减少嵌套和重复渲染、合理使用变量以及异步加载和渲染等。最后，通过案例分析，展示了实战中如何使用EJS构建静态网页、动态网页以及与后端数据交互。

详细学习请参考中文文档：[ejs.bootcss.com](https://ejs.bootcss.com "https://ejs.bootcss.com")

## 一、什么是EJS

### 1.1 EJS的背景和起源

EJS是一种模板引擎，最早由TJ Holowaychuk在2010年创建。它的目标是提供一种简洁、易用的方式来生成动态网页。EJS的设计受到了Ruby on Rails中ERB模板引擎的启发，并借鉴了其他模板引擎的一些特性。

**EJS 的含义你知道吗？**

“E” 代表什么？可以表示 “可嵌入（Embedded）”，也可以是“高效（Effective）”、“优雅（Elegant）”或者是“简单（Easy）”。EJS 是一套简单的模板语言，帮你利用普通的 JavaScript 代码生成 HTML 页面。EJS 没有如何组织内容的教条；也没有再造一套迭代和控制流语法；有的只是普通的 JavaScript 代码而已。

### 1.2 EJS的基本概念和设计思想

EJS使用嵌入式JavaScript代码来动态生成HTML。它采用了模板标记（<% %>）来执行JavaScript代码，以及插值标记（<%= %>)来输出变量的值。EJS的设计思想是尽可能保持简单和灵活，让开发者可以自由地组织和控制模板的结构和逻辑。

## 二、开始使用EJS

### 2.1 安装和配置EJS

要使用EJS，首先需要在项目中安装EJS包，并进行相应的配置。以下是安装和配置EJS的示例代码：

```js
// 使用npm安装EJS包
npm install ejs

// 在Node.js中通过require引入EJS
const ejs = require('ejs');

// 配置EJS模板引擎
app.set('view engine', 'ejs');
```

### 2.2 EJS的基本语法和标签

EJS使用尖括号加百分号的标记来执行JavaScript代码和插值。以下是EJS的基本语法和标签示例：

```js
<% // 执行JavaScript代码 %>
<%= // 输出变量的值 %>
<%- // 输出原始HTML代码 %>
<%# // 注释 %>
<%_ // 删除前导空格 %>
<% __line // 添加行号注释 %>
```

### 2.3 数据绑定和逻辑控制

EJS支持将数据绑定到模板中，使得页面内容能够动态生成。同时，EJS还提供了条件判断和循环等控制结构，以便根据不同的情况来展示不同的内容。以下是数据绑定和逻辑控制的示例代码：

```html
<h1><%= title %></h1> // 输出变量title的值

<% if (isAdmin) { %> // 条件判断
  <p>Welcome, admin!</p>
<% } else { %>
  <p>Welcome, guest!</p>
<% } %>

<ul>
<% for (let i = 0; i < items.length; i++) { %> // 循环
  <li><%= items[i] %></li>
<% } %>
</ul>
```

### 2.4 模板的继承和包含

在EJS中，可以使用模板的继承和包含功能来重用和组合模板。模板继承允许创建一个基础模板，并在其基础上定义子模板，从而实现模板的层次化管理。模板包含允许将多个模板组合在一起，以便构建更复杂的页面。以下是模板的继承和包含的示例代码：

base.ejs（基础模板）：

```html
<!DOCTYPE html>
<html>
<head>
  <title><%= title %></title>
</head>
<body>
  <%- body %>
</body>
</html>
```

index.ejs（子模板）：

```js
<% extends('base') %>

<% block('title') %>
  <%- title %>
<% endblock %>

<% block('body') %>
  <h1><%= heading %></h1>
  <p><%= content %></p>
<% endblock %>
```

## 三、EJS的核心特性详解

### 3.1 嵌入JavaScript代码

在EJS中，可以使用<% %>标记嵌入JavaScript代码。这使得开发者可以在模板中执行各种逻辑操作，如条件判断、循环等。

### 3.2 支持局部变量和全局变量

EJS支持局部变量和全局变量。局部变量在模板内部定义，并只在当前作用域可见。全局变量则可以在整个应用程序中共享和访问。

### 3.3 自定义过滤器和函数

EJS允许开发者定义自己的过滤器和函数，以便对数据进行处理和转换。通过自定义过滤器和函数，可以实现更灵活和高度定制化的模板功能。

### 3.4 支持条件判断和循环

EJS支持条件判断和循环等控制结构，以便根据不同的条件来展示不同的内容。条件判断可以使用if语句、switch语句等，循环可以使用for循环、while循环等。

### 3.5 支持模板的复用和组合

EJS支持模板的复用和组合，可以使用模板继承和包含功能来重用和组合模板。模板继承允许创建一个基础模板，并在其基础上定义子模板，从而实现模板的层次化管理。模板包含允许将多个模板组合在一起，以便构建更复杂的页面。

## 四、EJS性能优化技巧

### 4.1 缓存编译后的模板

为了提高性能，可以将编译后的模板缓存起来，避免重复编译。这样，在每次渲染时就可以直接使用缓存中的编译结果，减少了编译的开销。

### 4.2 减少嵌套和重复渲染

过多的嵌套和重复的渲染操作会增加模板的复杂度和渲染的时间。为了提高性能，应尽量减少模板的嵌套和重复渲染。

### 4.3 合理使用局部变量和全局变量

在模板中使用局部变量可以提高访问变量的效率。而过多的全局变量可能会导致命名冲突和性能下降，因此应该合理使用全局变量。

### 4.4 异步加载和渲染

对于大型页面或需要从后端加载数据的页面，可以考虑使用异步加载和渲染技术。这样可以提高页面的响应速度，并充分利用浏览器的并行加载能力。

### 4.5 其他性能优化建议

除了以上几点，还可以通过压缩HTML、CSS和JavaScript代码，减少网络传输大小；使用CDN加速静态资源的加载；优化数据库查询和数据处理等方式来提高页面的性能。

## 五、案例分析：实战中使用EJS

### 5.1 使用EJS构建静态网页

EJS可以用于构建静态的网页，只需将数据绑定到模板中，然后将渲染后的HTML保存到文件中即可。

```js
const ejs = require('ejs');
const fs = require('fs');

const template = fs.readFileSync('template.ejs', 'utf8');
const data = {
  title: 'My Website',
  content: 'Welcome to my website!'
};

const html = ejs.render(template, data);
fs.writeFileSync('index.html', html, 'utf8');
```

### 5.2 使用EJS构建动态网页

EJS也可以用于构建动态的网页，只需将数据绑定到模板中，然后将渲染后的HTML发送给客户端即可。

```js
const express = require('express');
const ejs = require('ejs');

const app = express();
app.set('view engine', 'ejs');

app.get('/', (req, res) => {
  const data = {
    title: 'Home',
    content: 'Welcome to my website!'
  };
  res.render('index', data);
});

app.listen(3000, () => {
  console.log('Server is running on port 3000');
});
```

### 5.3 使用EJS与后端数据交互

EJS可以与后端数据进行交互，通过模板中的变量和表达式来显示和处理后端传递的数据。

```js
// 后端 Node.js 代码（示例使用Express框架）
app.get('/users', (req, res) => {
  const users = [
    { name: 'Alice', age: 25 },
    { name: 'Bob', age: 30 },
    { name: 'Charlie', age: 35 }
  ];
  res.render('users', { users });
});
```

```js
<!-- 前端EJS模板代码 -->
<ul>
<% users.forEach(user => { %>
  <li><%= user.name %> (age <%= user.age %>)</li>
<% }) %>
</ul>
```

通过安装和配置EJS，我们可以使用它的基本语法和标签来实现数据绑定和逻辑控制，同时还能利用其核心特性和性能优化技巧来构建灵活、高效的网页应用。通过案例分析，展示了EJS在实战中的应用场景，包括构建静态网页、动态网页以及与后端数据交互。

## 六、EJS的局限性和其他模板引擎的比较

### 6.1 EJS的局限性

虽然EJS是一种简单而灵活的模板引擎，但它也存在一些局限性。以下是一些常见的EJS局限性：

-   学习曲线：对于新手来说，学习使用EJS可能需要一定的时间和经验积累，特别是对于不熟悉JavaScript语法和模板引擎概念的开发者。
    
-   性能：相对于其他一些高性能的模板引擎，EJS的性能可能稍低。特别是在大规模数据渲染和复杂逻辑处理方面，可能需要进行一些性能优化。
    
-   安全性：由于EJS允许执行嵌入的JavaScript代码，因此需要特别注意输入的数据的安全性，以避免潜在的安全风险，如XSS（跨站脚本攻击）等问题。
    

### 6.2 其他模板引擎的比较

除了EJS，还有其他许多流行的模板引擎可供选择。以下是一些与EJS相比的其他模板引擎，并对它们进行了简要比较：

-   Handlebars：Handlebars是一种基于Mustache模板语法的模板引擎，语法简洁易懂。相比EJS，Handlebars更强调模板的可读性和易维护性。
    
-   Jade/Pug：Jade（现称为Pug）是一种使用缩进和无闭合标签的模板引擎，具有简洁的语法和强大的表达能力。相对于EJS，Jade/Pug的模板文件通常更加精简和优雅。
    
-   Nunjucks：Nunjucks是一种基于Jinja2模板引擎的JavaScript模板引擎，具有灵活和强大的功能，支持模板继承、宏等高级特性。
    
-   React/Vue：React和Vue是基于组件化开发的前端框架，它们提供了自己的模板语法和渲染机制，具有更高的性能和更好的交互体验。
    

这些模板引擎各有特点，适用于不同的场景和需求。选择合适的模板引擎需要根据项目要求、开发经验和个人偏好进行权衡。

## 七、小结一下

本文详细介绍了EJS模板引擎的背景、特性和使用方法。我们了解了EJS的起源和设计思想，学习了EJS的基本语法和标签，并深入探讨了其核心特性，如嵌入JavaScript代码、变量绑定、条件判断和模板继承等。此外，我们还介绍了EJS的性能优化技巧，以帮助提高页面的加载速度和渲染效率。最后，通过实战案例的分析，展示了EJS在静态网页、动态网页和后端数据交互中的应用。

使用EJS可以方便地构建具有动态内容的网页，灵活处理数据和逻辑操作，并与后端进行交互。然而，开发者在选择模板引擎时需要综合考虑不同的因素，如学习曲线、性能要求和项目需求。

希望本文对您理解和使用EJS模板引擎有所帮助。如果你以后有机会使用它，欢迎共同学习进步深度挖掘。