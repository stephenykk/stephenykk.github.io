
<!DOCTYPE html><html lang="zh-CN">

<head>
  <meta charset="utf-8">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.27.0" theme-name="Stellar" theme-version="1.27.0">
  
  <meta name="generator" content="Hexo 7.1.1">
  <meta http-equiv='x-dns-prefetch-control' content='on' />
  
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" content="#f8f8f8">
  
  <title>[Reactè¿›é˜¶]APIå…¨é¢è§£è¯»ä¸åŸºç¡€å®è·µ - JKKéšç¬”</title>

  
    <meta name="description" content="åŸæ–‡åœ°å€ã€ŒReact è¿›é˜¶ã€ React å…¨éƒ¨ api è§£è¯»+åŸºç¡€å®è·µå¤§å…¨(å¤¯å®åŸºç¡€ 2 ä¸‡å­—æ€»ç»“) - æ˜é‡‘  å¾ˆå¤šåŒå­¦ç”¨reactå¼€å‘çš„æ—¶å€™ï¼ŒçœŸæ­£ç”¨åˆ°çš„Reactçš„apiå°‘ä¹‹åˆå°‘ï¼ŒåŸºæœ¬åœç•™åœ¨Component,React.memoç­‰å±‚é¢,å®é™…reactæºç ä¸­ï¼Œæš´éœ²å‡ºæ¥çš„æ–¹æ³•å¹¶ä¸å°‘ï¼Œåªæ˜¯æˆ‘ä»¬å¹³æ—¶å¾ˆå°‘ç”¨ã€‚ä½†æ˜¯Reactæš´éœ²å‡ºè¿™ä¹ˆå¤šapiå¹¶éæ²¡æœ‰ç”¨ï¼Œæƒ³è¦ç©è½¬react,å°±è¦æ˜ç™½è¿™äº›APIç©¶ç«Ÿæ˜¯å¹²ä»€">
<meta property="og:type" content="article">
<meta property="og:title" content="[Reactè¿›é˜¶]APIå…¨é¢è§£è¯»ä¸åŸºç¡€å®è·µ">
<meta property="og:url" content="https://panzhenjie.fun/2024/02/28/[React%E8%BF%9B%E9%98%B6]API%E5%85%A8%E9%9D%A2%E8%A7%A3%E8%AF%BB%E4%B8%8E%E5%9F%BA%E7%A1%80%E5%AE%9E%E8%B7%B5/index.html">
<meta property="og:site_name" content="JKKéšç¬”">
<meta property="og:description" content="åŸæ–‡åœ°å€ã€ŒReact è¿›é˜¶ã€ React å…¨éƒ¨ api è§£è¯»+åŸºç¡€å®è·µå¤§å…¨(å¤¯å®åŸºç¡€ 2 ä¸‡å­—æ€»ç»“) - æ˜é‡‘  å¾ˆå¤šåŒå­¦ç”¨reactå¼€å‘çš„æ—¶å€™ï¼ŒçœŸæ­£ç”¨åˆ°çš„Reactçš„apiå°‘ä¹‹åˆå°‘ï¼ŒåŸºæœ¬åœç•™åœ¨Component,React.memoç­‰å±‚é¢,å®é™…reactæºç ä¸­ï¼Œæš´éœ²å‡ºæ¥çš„æ–¹æ³•å¹¶ä¸å°‘ï¼Œåªæ˜¯æˆ‘ä»¬å¹³æ—¶å¾ˆå°‘ç”¨ã€‚ä½†æ˜¯Reactæš´éœ²å‡ºè¿™ä¹ˆå¤šapiå¹¶éæ²¡æœ‰ç”¨ï¼Œæƒ³è¦ç©è½¬react,å°±è¦æ˜ç™½è¿™äº›APIç©¶ç«Ÿæ˜¯å¹²ä»€">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5b4241cc9e044c608c5ca9c2648bcd48~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/030e96abf31d46ab8dd9f4f72389127c~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/823787ff6ac5492c9da013b1acb4dfbc~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4a2cd13003af4b5880b0bee19973fd44~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bf576c3e03714c1594bfddf2467fe877~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/229b794fe0f2449e9a18dc7f3733a395~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5c84f768c1d440ccb4523d51a7065b79~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4a55db52d97845b2bc29d9078680ef82~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8d4b0529cbea4e25bfcf1168d6e6d7b6~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4393bac1d6b2428d9365b0f3ff480419~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9984deb7d57d42fd8661c4c14ea19d72~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dfad646de7b3453bbb2c3d66c635f13b~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b7ef80c8874c4a509c74fefd8b1e4e05~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4247073612eb4b609a1ca7528a1a07f1~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b8e1630e79f54b54b4291b7f4130aebe~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0158172495a648df8e804a0707f993bc~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/04f10179d259460884beb8f035fa15e4~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/64a4a789f44747ba93fa54bc94fa7f8b~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a16924238b9042739100e51034e5f810~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/05aa09a275e6472a8ce50ec58e29a8ab~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/978f814d97e441838bad1d654ba1ef42~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8e8c05f0c82c43719079d4db9536abc0~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/23d877cf3a5b417ba6162f0c259b1c45~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1842abaa8cb840108f6a5c90cb349aac~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/29b6f884f2c147ee9a20400ad7477e77~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4b799b2b8f514ae183382d5ed875d0e9~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f7eba600db1c44cb956e380cb922226d~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f9acc582f69e461caf0887f49d710a35~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="og:image" content="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/15ebcd1a23e64561ae6346d4be7e958a~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
<meta property="article:published_time" content="2024-02-28T04:39:13.000Z">
<meta property="article:modified_time" content="2024-10-08T14:56:16.719Z">
<meta property="article:author" content="stephenykk">
<meta property="article:tag" content="React">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5b4241cc9e044c608c5ca9c2648bcd48~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp">
  
  
  
  <meta name="keywords" content="React">

  <!-- feed -->
  

  <link rel="stylesheet" href="/css/main.css?v=1.27.0">

  

  

  
</head>
<body>

<div class="l_body s:aa content tech" id="start" layout="post" ><aside class="l_left"><div class="leftbar-container">


<header class="header"><div class="logo-wrap"><a class="avatar" href="/about/"><div class="bg" style="opacity:0;background-image:url(https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/rainbow64@3x.webp);"></div><img  referrerpolicy="no-referrer" no-lazy class="avatar" src="https://avatars.githubusercontent.com/u/7259892?s=400&u=01563911436a79d809f95ca8d1191c8a7ecc6f56&v=4" onerror="javascript:this.classList.add('error');this.src='https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/image/2659360.svg';"></a><a class="title" href="/"><div class="main" ff="title">JKKéšç¬”</div><div class="sub normal cap">æ¬ç –å·¥</div><div class="sub hover cap" style="opacity:0"> ä½†è¡Œå¥½äº‹ è«é—®å‰ç¨‹</div></a></div></header>

<div class="nav-area">
<div class="search-wrapper" id="search-wrapper"><form class="search-form"><a class="search-button" onclick="document.getElementById(&quot;search-input&quot;).focus();"><svg t="1705074644177" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1560" width="200" height="200"><path d="M1008.839137 935.96571L792.364903 719.491476a56.783488 56.783488 0 0 0-80.152866 0 358.53545 358.53545 0 1 1 100.857314-335.166073 362.840335 362.840335 0 0 1-3.689902 170.145468 51.248635 51.248635 0 1 0 99.217358 26.444296 462.057693 462.057693 0 1 0-158.255785 242.303546l185.930047 185.725053a51.248635 51.248635 0 0 0 72.568068 0 51.248635 51.248635 0 0 0 0-72.978056z" p-id="1561"></path><path d="M616.479587 615.969233a50.428657 50.428657 0 0 0-61.498362-5.534852 174.655348 174.655348 0 0 1-177.525271 3.484907 49.403684 49.403684 0 0 0-58.833433 6.76482l-3.074918 2.869923a49.403684 49.403684 0 0 0 8.609771 78.10292 277.767601 277.767601 0 0 0 286.992355-5.739847 49.403684 49.403684 0 0 0 8.404776-76.667958z" p-id="1562"></path></svg></a><input type="text" class="search-input" id="search-input" placeholder="ç«™å†…æœç´¢"></form><div id="search-result"></div><div class="search-no-result">æ²¡æœ‰æ‰¾åˆ°å†…å®¹ï¼</div></div>


<nav class="menu dis-select"></nav>
</div>
<div class="widgets">


<widget class="widget-wrapper post-list"><div class="widget-header dis-select"><span class="name">æœ€è¿‘æ›´æ–°</span></div><div class="widget-body fs14"><a class="item title" href="/2024/02/26/Python%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/"><span class="title">PythonåŸºç¡€æ•™ç¨‹</span></a><a class="item title" href="/2024/04/10/curl%E5%AE%9E%E7%94%A8%E6%95%99%E7%A8%8B/"><span class="title">curlå®ç”¨æ•™ç¨‹</span></a><a class="item title" href="/2024/03/12/%E5%8D%81%E5%88%86%E9%92%9F%E5%AD%A6%E4%BC%9AWebSocket/"><span class="title">ååˆ†é’Ÿå­¦ä¼šWebSocket</span></a><a class="item title" href="/2024/07/31/%E4%B8%80%E6%96%87%E5%90%83%E9%80%8F-React-SSR-%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%B8%B2%E6%9F%93%E5%92%8C%E5%90%8C%E6%9E%84%E5%8E%9F%E7%90%86/"><span class="title">ä¸€æ–‡åƒé€ React SSR æœåŠ¡ç«¯æ¸²æŸ“å’ŒåŒæ„åŸç†</span></a><a class="item title" href="/2024/03/26/Hexo-Stellar%E4%B8%BB%E9%A2%98%E6%A0%87%E7%AD%BE%E5%85%A5%E9%97%A8/"><span class="title">Hexo Stellarä¸»é¢˜æ ‡ç­¾ä½¿ç”¨å…¥é—¨</span></a><a class="item title" href="/2024/03/07/Grid%E5%B8%83%E5%B1%80%E8%AF%A6%E8%A7%A3/"><span class="title">Gridå¸ƒå±€è¯¦è§£</span></a><a class="item title" href="/2024/03/01/Nginx%E5%92%8CPHP%E7%9A%84%E9%85%8D%E7%BD%AE/"><span class="title">Nginxå’ŒPHPçš„é…ç½®</span></a><a class="item title" href="/2024/04/12/SVG%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%EF%BC%88%E5%9B%BE%E8%A7%A3%E7%89%88%EF%BC%89/"><span class="title">SVGå¿«é€Ÿå…¥é—¨ï¼ˆå›¾è§£ç‰ˆï¼‰</span></a><a class="item title" href="/2024/03/12/%E6%89%8B%E6%8A%8A%E6%89%8B%E5%B8%A6%E4%BD%A0%E5%85%A5%E9%97%A8NextJs/"><span class="title">æ‰‹æŠŠæ‰‹å¸¦ä½ å…¥é—¨NextJs</span></a><a class="item title" href="/2024/04/12/Canvas%E5%85%A5%E9%97%A8%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%A7%A3/"><span class="title">Canvaså…¥é—¨çŸ¥è¯†å›¾è§£</span></a></div></widget>
</div>

</div></aside><div class="l_main" id="main">





<div class="article banner top">
  <div class="content">
    <div class="top bread-nav footnote"><div class="left"><div class="flex-row" id="breadcrumb"><a class="cap breadcrumb" href="/">ä¸»é¡µ</a>
<span class="sep"></span><a class="cap breadcrumb" href="/">æ–‡ç« </a><span class="sep"></span><a class="cap breadcrumb-link" href="/categories/React/">React</a></div>
<div class="flex-row" id="post-meta"><span class="text created">å‘å¸ƒäºï¼š<time datetime="2024-02-28T04:39:13.000Z">2024-02-28</time></span><span class="sep updated"></span><span class="text updated">æ›´æ–°äºï¼š<time datetime="2024-10-08T14:56:16.719Z">2024-10-08</time></span></div></div></div>
    
    <div class="bottom only-title">
      
      <div class="text-area">
        <h1 class="text title"><span>[Reactè¿›é˜¶]APIå…¨é¢è§£è¯»ä¸åŸºç¡€å®è·µ</span></h1>
        
      </div>
    </div>
    
  </div>
  </div><article class="md-text content"><blockquote>
<p>åŸæ–‡åœ°å€<a target="_blank" rel="noopener" href="https://juejin.cn/post/6950063294270930980?searchId=2024022812341241274B98744BCB602F1E">ã€ŒReact è¿›é˜¶ã€ React å…¨éƒ¨ api è§£è¯»+åŸºç¡€å®è·µå¤§å…¨(å¤¯å®åŸºç¡€ 2 ä¸‡å­—æ€»ç»“) - æ˜é‡‘</a></p>
</blockquote>
<p>å¾ˆå¤šåŒå­¦ç”¨<code>react</code>å¼€å‘çš„æ—¶å€™ï¼ŒçœŸæ­£ç”¨åˆ°çš„<code>React</code>çš„<code>api</code>å°‘ä¹‹åˆå°‘ï¼ŒåŸºæœ¬åœç•™åœ¨<code>Component</code>,<code>React.memo</code>ç­‰å±‚é¢,å®é™…<code>react</code>æºç ä¸­ï¼Œæš´éœ²å‡ºæ¥çš„æ–¹æ³•å¹¶ä¸å°‘ï¼Œåªæ˜¯æˆ‘ä»¬å¹³æ—¶å¾ˆå°‘ç”¨ã€‚ä½†æ˜¯<code>React</code>æš´éœ²å‡ºè¿™ä¹ˆå¤š<code>api</code>å¹¶éæ²¡æœ‰ç”¨ï¼Œæƒ³è¦ç©è½¬<code>react</code>,å°±è¦æ˜ç™½è¿™äº›<code>API</code>ç©¶ç«Ÿæ˜¯å¹²ä»€ä¹ˆçš„ï¼Œåº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Œä»Šå¤©å°±è®©æˆ‘ä»¬ä»<code>react</code> åˆ° <code>react-dom</code>,ä¸€æ¬¡æ€§æŠŠ<code>react</code>ç”Ÿäº§ç¯å¢ƒçš„æš´éœ²<code>api</code>å¤ä¹ ä¸ªé(æ¶µç›– 90%+)ã€‚</p>
<p>æˆ‘ä»¬æŠŠ<code>react</code>,<code>API</code>ï¼Œåˆ†ä¸º<strong>ç»„ä»¶ç±»</strong>ï¼Œ<strong>å·¥å…·ç±»</strong>ï¼Œ**<code>hooks</code>**ï¼Œå†åŠ ä¸Š <strong><code>react-dom</code></strong> ï¼Œä¸€å…±å››å¤§æ–¹å‘ï¼Œåˆ†åˆ«åŠ ä»¥æ¢è®¨ã€‚</p>
<p>ä¸ºäº†èƒ½è®©å±å¹•å‰çš„ä½ ï¼Œæ›´ç†è§£<code>api</code>,æˆ‘æ˜¯ç»å°½è„‘æ±,æœ¬æ–‡çš„æ¯ä¸€ä¸ª<code>api</code>åŸºæœ¬éƒ½ä¼šå‡ºä¸€ä¸ª<code>demo</code>æ¼”ç¤ºæ•ˆæœ,å¼¥è¡¥ä¸€ä¸‹å¤©ä¹¦èˆ¬çš„<code>react</code>æ–‡æ¡£ ğŸ˜‚ğŸ˜‚ğŸ˜‚ï¼Œè¿˜æœ‰å°±æ˜¯æˆ‘å¯¹<code>api</code>åŸºæœ¬æ¦‚å¿µçš„ç†è§£ã€‚åˆ›ä½œä¸æ˜“ï¼Œå¸Œæœ›å±å¹•å‰çš„ä½ èƒ½ç»™ç¬”è€…èµä¸ª<strong>èµ</strong>ï¼Œä»¥æ­¤é¼“åŠ±æˆ‘ç»§ç»­åˆ›ä½œå‰ç«¯ç¡¬æ–‡ã€‚</p>
<p>è€è§„çŸ©ï¼Œæˆ‘ä»¬å¸¦ç€ç–‘é—®å¼€å§‹ä»Šå¤©çš„é˜…è¯»(<strong>è‡ªæµ‹æŒæ¡ç¨‹åº¦</strong>)ï¼Ÿ</p>
<ul>
<li>1 <code>react</code>æš´éœ²çš„<code>api</code>æœ‰å“ªäº›ï¼Œè¯¥å¦‚ä½•ä½¿ç”¨ï¼Ÿ</li>
<li>2 <code>react</code>æä¾›äº†å“ªäº›è‡ªæµ‹æ€§èƒ½çš„æ‰‹æ®µï¼Ÿ</li>
<li>3 <code>ref</code>æ—¢ç„¶ä¸èƒ½ç”¨åœ¨å‡½æ•°ç»„ä»¶ä¸­ï¼Œé‚£ä¹ˆçˆ¶ç»„ä»¶å¦‚ä½•æ§åˆ¶å‡½æ•°å­ç»„ä»¶å†…çš„<code>state</code>å’Œæ–¹æ³•ï¼Ÿ</li>
<li>4 <code>createElement</code>å’Œ<code>cloneElement</code>æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œåº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>5 <code>react</code>å†…ç½®çš„<code>children</code>éå†æ–¹æ³•ï¼Œå’Œæ•°ç»„æ–¹æ³•,æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</li>
<li>6 <code>react</code>æ€ä¹ˆå°†å­å…ƒç´ æ¸²æŸ“åˆ°çˆ¶å…ƒç´ ä¹‹å¤–çš„æŒ‡å®šå®¹å™¨ä¸­ï¼Ÿ</li>
<li>â€¦</li>
</ul>
<p>æˆ‘ç›¸ä¿¡è¯»å®Œè¿™ç¯‡æ–‡ç« ï¼Œè¿™äº›é—®é¢˜å…¨éƒ½ä¼šè¿åˆƒè€Œè§£ï¼Ÿ</p>
<h1 id="ç»„ä»¶ç±»"><a href="#ç»„ä»¶ç±»" class="headerlink" title="ç»„ä»¶ç±»"></a>ç»„ä»¶ç±»</h1><p>ç»„ä»¶ç±»ï¼Œè¯¦ç»†åˆ†çš„è¯æœ‰ä¸‰ç§ç±»ï¼Œç¬¬ä¸€ç±»è¯´ç™½äº†å°±æ˜¯æˆ‘å¹³æ—¶ç”¨äºç»§æ‰¿çš„åŸºç±»ç»„ä»¶<code>Component</code>,<code>PureComponent</code>,è¿˜æœ‰å°±æ˜¯<code>react</code>æä¾›çš„å†…ç½®çš„ç»„ä»¶ï¼Œæ¯”å¦‚<code>Fragment</code>,<code>StrictMode</code>,å¦ä¸€éƒ¨åˆ†å°±æ˜¯é«˜é˜¶ç»„ä»¶<code>forwardRef</code>,<code>memo</code>ç­‰ã€‚</p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5b4241cc9e044c608c5ca9c2648bcd48~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="comp.jpg"></p>
<h2 id="Component"><a href="#Component" class="headerlink" title="Component"></a>Component</h2><p><code>Component</code>æ˜¯<code>class</code>ç»„ä»¶çš„æ ¹åŸºã€‚ ç±»ç»„ä»¶ä¸€åˆ‡å§‹äº<code>Component</code>ã€‚å¯¹äº<code>React.Component</code>ä½¿ç”¨ï¼Œæˆ‘ä»¬æ²¡æœ‰ä»€ä¹ˆå¥½è®²çš„ã€‚æˆ‘ä»¬è¿™é‡Œé‡ç‚¹ç ”ç©¶ä¸€ä¸‹<code>react</code>å¯¹<code>Component</code>åšäº†äº›ä»€ä¹ˆã€‚</p>
<p><code>react/src/ReactBaseClasses.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Component</span>(<span class="hljs-params">props, context, updater</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span> = props;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span> = context;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">refs</span> = emptyObject;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">updater</span> = updater || <span class="hljs-title class_">ReactNoopUpdateQueue</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>è¿™å°±æ˜¯<code>Component</code>å‡½æ•°ï¼Œå…¶ä¸­<code>updater</code>å¯¹è±¡ä¸Šä¿å­˜ç€æ›´æ–°ç»„ä»¶çš„æ–¹æ³•ã€‚</p>
<p><strong>æˆ‘ä»¬å£°æ˜çš„ç±»ç»„ä»¶æ˜¯ä»€ä¹ˆæ—¶å€™ä»¥ä½•ç§å½¢å¼è¢«å®ä¾‹åŒ–çš„å‘¢ï¼Ÿ</strong></p>
<p><code>react-reconciler/src/ReactFiberClassComponent.js</code></p>
<p><strong>constructClassInstance</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">constructClassInstance</span>(<span class="hljs-params">workInProgress, ctor, props</span>) &#123;<br>    <span class="hljs-keyword">const</span> instance = <span class="hljs-keyword">new</span> <span class="hljs-title function_">ctor</span>(props, context);<br>    instance.<span class="hljs-property">updater</span> = &#123;<br>        isMounted,<br>        <span class="hljs-title function_">enqueueSetState</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-comment">/* setState è§¦å‘è¿™é‡Œé¢çš„é€»è¾‘ */</span><br>        &#125;,<br>        <span class="hljs-title function_">enqueueReplaceState</span>(<span class="hljs-params"></span>) &#123;&#125;,<br>        <span class="hljs-title function_">enqueueForceUpdate</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-comment">/* forceUpdate è§¦å‘è¿™é‡Œçš„é€»è¾‘ */</span><br>        &#125;,<br>    &#125;;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¯¹äº<code>Component</code>ï¼Œ <code>react</code> å¤„ç†é€»è¾‘è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œå®ä¾‹åŒ–æˆ‘ä»¬ç±»ç»„ä»¶ï¼Œç„¶åèµ‹å€¼<code>updater</code>å¯¹è±¡ï¼Œè´Ÿè´£ç»„ä»¶çš„æ›´æ–°ã€‚ç„¶ååœ¨ç»„ä»¶å„ä¸ªé˜¶æ®µï¼Œæ‰§è¡Œç±»ç»„ä»¶çš„<code>render</code>å‡½æ•°ï¼Œå’Œå¯¹åº”çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°å°±å¯ä»¥äº†ã€‚</p>
<h2 id="PureComponent"><a href="#PureComponent" class="headerlink" title="PureComponent"></a>PureComponent</h2><p><code>PureComponent</code>å’Œ <code>Component</code>ç”¨æ³•ï¼Œå·®ä¸å¤šä¸€æ ·ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œçº¯ç»„ä»¶<code>PureComponent</code>ä¼šæµ…æ¯”è¾ƒï¼Œ<code>props</code>å’Œ<code>state</code>æ˜¯å¦ç›¸åŒï¼Œæ¥å†³å®šæ˜¯å¦é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚æ‰€ä»¥ä¸€èˆ¬ç”¨äº<strong>æ€§èƒ½è°ƒä¼˜</strong>ï¼Œå‡å°‘<strong>render</strong>æ¬¡æ•°ã€‚</p>
<p>ä»€ä¹ˆå«åš<strong>æµ…æ¯”è¾ƒ</strong>ï¼Œæˆ‘è¿™é‡Œä¸¾ä¸ªåˆ—å­ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.PureComponent</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) &#123;<br>        <span class="hljs-variable language_">super</span>(props);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = &#123;<br>            <span class="hljs-attr">data</span>: &#123;<br>                <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;alien&quot;</span>,<br>                <span class="hljs-attr">age</span>: <span class="hljs-number">28</span>,<br>            &#125;,<br>        &#125;;<br>    &#125;<br>    handerClick = <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-keyword">const</span> &#123; data &#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>;<br>        data.<span class="hljs-property">age</span>++;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; data &#125;);<br>    &#125;;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">const</span> &#123; data &#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>;<br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;box&quot;</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;show&quot;</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span> ä½ çš„å§“åæ˜¯: &#123;data.name&#125; <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span> å¹´é¾„ï¼š &#123;data.age&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.handerClick&#125;</span>&gt;</span>age++<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        );<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/030e96abf31d46ab8dd9f4f72389127c~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="pureComponent.gif"> <strong>ç‚¹å‡»æŒ‰é’®ï¼Œæ²¡æœ‰ä»»ä½•ååº”</strong>ï¼Œå› ä¸º<code>PureComponent</code>ä¼šæ¯”è¾ƒä¸¤æ¬¡<code>data</code>å¯¹è±¡ï¼Œéƒ½æŒ‡å‘åŒä¸€ä¸ª<code>data</code>,æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œæ‰€ä»¥ä¸æ›´æ–°è§†å›¾ã€‚</p>
<p>è§£å†³è¿™ä¸ªé—®é¢˜å¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨<code>handerClick</code>äº‹ä»¶ä¸­è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">data</span>: &#123; ...data &#125; &#125;);<br></code></pre></td></tr></table></figure>

<p><strong>æµ…æ‹·è´</strong>å°±èƒ½æ ¹æœ¬è§£å†³é—®é¢˜ã€‚</p>
<h2 id="memo"><a href="#memo" class="headerlink" title="memo"></a>memo</h2><p><code>React.memo</code>å’Œ<code>PureComponent</code>ä½œç”¨ç±»ä¼¼ï¼Œå¯ä»¥ç”¨ä½œæ€§èƒ½ä¼˜åŒ–ï¼Œ<code>React.memo</code> æ˜¯é«˜é˜¶ç»„ä»¶ï¼Œå‡½æ•°ç»„ä»¶å’Œç±»ç»„ä»¶éƒ½å¯ä»¥ä½¿ç”¨ï¼Œ å’ŒåŒºåˆ«<code>PureComponent</code>æ˜¯ <code>React.memo</code>åªèƒ½å¯¹<code>props</code>çš„æƒ…å†µç¡®å®šæ˜¯å¦æ¸²æŸ“ï¼Œè€Œ<code>PureComponent</code>æ˜¯é’ˆå¯¹<code>props</code>å’Œ<code>state</code>ã€‚</p>
<p><code>React.memo</code> æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°åŸå§‹ç»„ä»¶æœ¬èº«ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼Œå¯ä»¥æ ¹æ®ä¸€æ¬¡æ›´æ–°ä¸­<code>props</code>æ˜¯å¦ç›¸åŒå†³å®šåŸå§‹ç»„ä»¶æ˜¯å¦é‡æ–°æ¸²æŸ“ã€‚æ˜¯ä¸€ä¸ªè¿”å›å¸ƒå°”å€¼ï¼Œ<code>true</code> è¯æ˜ç»„ä»¶æ— é¡»é‡æ–°æ¸²æŸ“ï¼Œ<code>false</code>è¯æ˜ç»„ä»¶éœ€è¦é‡æ–°æ¸²æŸ“ï¼Œè¿™ä¸ªå’Œç±»ç»„ä»¶ä¸­çš„<code>shouldComponentUpdate()</code>æ­£å¥½ç›¸å ã€‚</p>
<p><strong>React.memo: ç¬¬äºŒä¸ªå‚æ•° è¿”å› <code>true</code> ç»„ä»¶ä¸æ¸²æŸ“ ï¼Œ è¿”å› <code>false</code> ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</strong> <strong>shouldComponentUpdate: è¿”å› <code>true</code> ç»„ä»¶æ¸²æŸ“ ï¼Œ è¿”å› <code>false</code> ç»„ä»¶ä¸æ¸²æŸ“ã€‚</strong></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬åšä¸€ä¸ªåœºæ™¯ï¼Œæ§åˆ¶ç»„ä»¶åœ¨ä»…æ­¤ä¸€ä¸ª<code>props</code>æ•°å­—å˜é‡ï¼Œä¸€å®šèŒƒå›´æ¸²æŸ“ã€‚</p>
<p>ä¾‹å­ ğŸŒ°ï¼š</p>
<p>æ§åˆ¶ <code>props</code> ä¸­çš„ <code>number</code> ï¼š</p>
<ul>
<li>1 åªæœ‰ <code>number</code> æ›´æ”¹ï¼Œç»„ä»¶æ¸²æŸ“ã€‚</li>
<li>2 åªæœ‰ <code>number</code> å°äº 5 ï¼Œç»„ä»¶æ¸²æŸ“ã€‚</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">TextMemo</span>(<span class="hljs-params">props</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;å­ç»„ä»¶æ¸²æŸ“&quot;</span>);<br>    <span class="hljs-keyword">if</span> (props) <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>hello,world<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;<br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">controlIsRender</span> = (<span class="hljs-params">pre, next</span>) =&gt; &#123;<br>    <span class="hljs-keyword">if</span> (pre.<span class="hljs-property">number</span> === next.<span class="hljs-property">number</span>) &#123;<br>        <span class="hljs-comment">// number ä¸æ”¹å˜ ï¼Œä¸æ¸²æŸ“ç»„ä»¶</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (pre.<span class="hljs-property">number</span> !== next.<span class="hljs-property">number</span> &amp;&amp; next.<span class="hljs-property">number</span> &gt; <span class="hljs-number">5</span>) &#123;<br>        <span class="hljs-comment">// number æ”¹å˜ ï¼Œä½†å€¼å¤§äº5 ï¼Œ ä¸æ¸²æŸ“ç»„ä»¶</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// å¦åˆ™æ¸²æŸ“ç»„ä»¶</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">NewTexMemo</span> = <span class="hljs-title function_">memo</span>(<span class="hljs-title class_">TextMemo</span>, controlIsRender);<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) &#123;<br>        <span class="hljs-variable language_">super</span>(props);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = &#123;<br>            <span class="hljs-attr">number</span>: <span class="hljs-number">1</span>,<br>            <span class="hljs-attr">num</span>: <span class="hljs-number">1</span>,<br>        &#125;;<br>    &#125;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">const</span> &#123; num, number &#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>;<br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                    æ”¹å˜numï¼šå½“å‰å€¼ &#123;num&#125;</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> this.setState(&#123; num: num + 1 &#125;)&#125;&gt;</span><br><span class="language-xml">                        num++</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> this.setState(&#123; num: num - 1 &#125;)&#125;&gt;</span><br><span class="language-xml">                        num--</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                    æ”¹å˜numberï¼š å½“å‰å€¼ &#123;number&#125;</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span></span></span><br><span class="hljs-tag"><span class="language-xml">                        <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> this.setState(&#123; number: number + 1 &#125;)&#125;</span><br><span class="language-xml">                    &gt;</span><br><span class="language-xml">                        &#123;&quot; &quot;&#125;</span><br><span class="language-xml">                        number ++</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span></span></span><br><span class="hljs-tag"><span class="language-xml">                        <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> this.setState(&#123; number: number - 1 &#125;)&#125;</span><br><span class="language-xml">                    &gt;</span><br><span class="language-xml">                        &#123;&quot; &quot;&#125;</span><br><span class="language-xml">                        number --&#123;&quot; &quot;&#125;</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">NewTexMemo</span> <span class="hljs-attr">num</span>=<span class="hljs-string">&#123;num&#125;</span> <span class="hljs-attr">number</span>=<span class="hljs-string">&#123;number&#125;</span> /&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        );<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ•ˆæœï¼š</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/823787ff6ac5492c9da013b1acb4dfbc~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="memo.gif"></p>
<p>å®Œç¾è¾¾åˆ°äº†æ•ˆæœï¼Œ<code>React.memo</code>ä¸€å®šç¨‹åº¦ä¸Šï¼Œå¯ä»¥ç­‰ä»·äºç»„ä»¶å¤–éƒ¨ä½¿ç”¨<code>shouldComponentUpdate</code> ï¼Œç”¨äºæ‹¦æˆªæ–°è€<code>props</code>ï¼Œç¡®å®šç»„ä»¶æ˜¯å¦æ›´æ–°ã€‚</p>
<h2 id="forwardRef"><a href="#forwardRef" class="headerlink" title="forwardRef"></a>forwardRef</h2><p>å®˜ç½‘å¯¹<code>forwardRef</code>çš„æ¦‚å¿µå’Œç”¨æ³•å¾ˆç¬¼ç»Ÿï¼Œä¹Ÿæ²¡æœ‰ç»™å®šä¸€ä¸ªå…·ä½“çš„æ¡ˆä¾‹ã€‚å¾ˆå¤šåŒå­¦ä¸çŸ¥é“ <code>forwardRef</code>å…·ä½“æ€ä¹ˆç”¨ï¼Œä¸‹é¢æˆ‘ç»“åˆå…·ä½“ä¾‹å­ç»™å¤§å®¶è®²è§£<code>forwardRef</code>åº”ç”¨åœºæ™¯ã€‚</p>
<p><strong>1 è½¬å‘å¼•å…¥ Ref</strong></p>
<p>è¿™ä¸ªåœºæ™¯å®é™…å¾ˆç®€å•ï¼Œæ¯”å¦‚çˆ¶ç»„ä»¶æƒ³è·å–å­™ç»„ä»¶ï¼ŒæŸä¸€ä¸ª<code>dom</code>å…ƒç´ ã€‚è¿™ç§éš”ä»£<code>ref</code>è·å–å¼•ç”¨ï¼Œå°±éœ€è¦<code>forwardRef</code>æ¥åŠ©åŠ›ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Son</span>(<span class="hljs-params">props</span>) &#123;<br>    <span class="hljs-keyword">const</span> &#123; grandRef &#125; = props;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span> i am alien <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;grandRef&#125;</span>&gt;</span>è¿™ä¸ªæ˜¯æƒ³è¦è·å–å…ƒç´ <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Father</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) &#123;<br>        <span class="hljs-variable language_">super</span>(props);<br>    &#125;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">Son</span> <span class="hljs-attr">grandRef</span>=<span class="hljs-string">&#123;this.props.grandRef&#125;</span> /&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        );<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">NewFather</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">forwardRef</span>(<span class="hljs-function">(<span class="hljs-params">props, ref</span>) =&gt;</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Father</span> <span class="hljs-attr">grandRef</span>=<span class="hljs-string">&#123;ref&#125;</span> &#123;<span class="hljs-attr">...props</span>&#125; /&gt;</span></span><br>));<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">GrandFather</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) &#123;<br>        <span class="hljs-variable language_">super</span>(props);<br>    &#125;<br>    node = <span class="hljs-literal">null</span>;<br>    <span class="hljs-title function_">componentDidMount</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">node</span>);<br>    &#125;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">NewFather</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;(node)</span> =&gt;</span> (this.node = node)&#125; /&gt;</span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        );<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ•ˆæœ</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4a2cd13003af4b5880b0bee19973fd44~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="forwaedRef.jpg"></p>
<p><code>react</code>ä¸å…è®¸<code>ref</code>é€šè¿‡<code>props</code>ä¼ é€’ï¼Œå› ä¸ºç»„ä»¶ä¸Šå·²ç»æœ‰ <code>ref</code> è¿™ä¸ªå±æ€§,åœ¨ç»„ä»¶è°ƒå’Œè¿‡ç¨‹ä¸­ï¼Œå·²ç»è¢«ç‰¹æ®Šå¤„ç†ï¼Œ<code>forwardRef</code>å‡ºç°å°±æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒæŠŠ<code>ref</code>è½¬å‘åˆ°è‡ªå®šä¹‰çš„<code>forwardRef</code>å®šä¹‰çš„å±æ€§ä¸Šï¼Œè®©<code>ref</code>ï¼Œå¯ä»¥é€šè¿‡<code>props</code>ä¼ é€’ã€‚</p>
<p><strong>2 é«˜é˜¶ç»„ä»¶è½¬å‘ Ref</strong></p>
<p>ä¸€æ–‡åƒé€<code>hoc</code>æ–‡ç« ä¸­è®²åˆ°ï¼Œç”±äºå±æ€§ä»£ç†çš„<code>hoc</code>ï¼Œè¢«åŒ…è£¹ä¸€å±‚ï¼Œæ‰€ä»¥å¦‚æœæ˜¯ç±»ç»„ä»¶ï¼Œæ˜¯é€šè¿‡<code>ref</code>æ‹¿ä¸åˆ°åŸå§‹ç»„ä»¶çš„å®ä¾‹çš„ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>forWardRef</code>è½¬å‘<code>ref</code>ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">HOC</span>(<span class="hljs-params">Component</span>) &#123;<br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Wrap</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>        <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">const</span> &#123; forwardedRef, ...otherprops &#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>;<br>            <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Component</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;forwardedRef&#125;</span> &#123;<span class="hljs-attr">...otherprops</span>&#125; /&gt;</span></span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">React</span>.<span class="hljs-title function_">forwardRef</span>(<span class="hljs-function">(<span class="hljs-params">props, ref</span>) =&gt;</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Wrap</span> <span class="hljs-attr">forwardedRef</span>=<span class="hljs-string">&#123;ref&#125;</span> &#123;<span class="hljs-attr">...props</span>&#125; /&gt;</span></span><br>    ));<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    <span class="hljs-title function_">componentDidMount</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">666</span>);<br>    &#125;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>hello,world<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HocIndex</span> = <span class="hljs-title function_">HOC</span>(<span class="hljs-title class_">Index</span>, <span class="hljs-literal">true</span>);<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> () =&gt; &#123;<br>    <span class="hljs-keyword">const</span> node = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);<br>    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-comment">/* å°±å¯ä»¥è·¨å±‚çº§ï¼Œæ•è·åˆ° Index ç»„ä»¶çš„å®ä¾‹äº† */</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(node.<span class="hljs-property">current</span>.<span class="hljs-property">componentDidMount</span>);<br>    &#125;, []);<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">HocIndex</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;node&#125;</span> /&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;;<br></code></pre></td></tr></table></figure>

<p>å¦‚ä¸Šï¼Œè§£å†³äº†é«˜é˜¶ç»„ä»¶å¼•å…¥<code>Ref</code>çš„é—®é¢˜ã€‚</p>
<h2 id="lazy"><a href="#lazy" class="headerlink" title="lazy"></a>lazy</h2><blockquote>
<p>React.lazy å’Œ Suspense æŠ€æœ¯è¿˜ä¸æ”¯æŒæœåŠ¡ç«¯æ¸²æŸ“ã€‚å¦‚æœä½ æƒ³è¦åœ¨ä½¿ç”¨æœåŠ¡ç«¯æ¸²æŸ“çš„åº”ç”¨ä¸­ä½¿ç”¨ï¼Œæˆ‘ä»¬æ¨è Loadable Components è¿™ä¸ªåº“</p>
</blockquote>
<p><code>React.lazy</code>å’Œ<code>Suspense</code>é…åˆä¸€èµ·ç”¨ï¼Œèƒ½å¤Ÿæœ‰åŠ¨æ€åŠ è½½ç»„ä»¶çš„æ•ˆæœã€‚<code>React.lazy</code> æ¥å—ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°éœ€è¦åŠ¨æ€è°ƒç”¨ <code>import()</code>ã€‚å®ƒå¿…é¡»è¿”å›ä¸€ä¸ª <code>Promise</code> ï¼Œè¯¥ <code>Promise</code> éœ€è¦ <code>resolve</code> ä¸€ä¸ª <code>default export</code> çš„ <code>React</code> ç»„ä»¶ã€‚</p>
<p>æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸ªåŠ¨æ€åŠ è½½çš„åœºæ™¯ã€‚</p>
<p><strong>çˆ¶ç»„ä»¶</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Test</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./comTest&quot;</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">LazyComponent</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<br>    <span class="hljs-function">() =&gt;</span><br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;<br>            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>                <span class="hljs-title function_">resolve</span>(&#123;<br>                    <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Test</span> /&gt;</span></span>,<br>                &#125;);<br>            &#125;, <span class="hljs-number">2000</span>);<br>        &#125;)<br>);<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;context_box&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">marginTop:</span> &quot;<span class="hljs-attr">50px</span>&quot; &#125;&#125;&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">React.Suspense</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">fallback</span>=<span class="hljs-string">&#123;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                        &lt;<span class="hljs-attr">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;icon&quot;</span>&gt;</span></span><br><span class="language-xml">                            <span class="hljs-tag">&lt;<span class="hljs-name">SyncOutlined</span> <span class="hljs-attr">spin</span> /&gt;</span></span><br><span class="language-xml">                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                    &#125;</span><br><span class="language-xml">                &gt;</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">LazyComponent</span> /&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">React.Suspense</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        );<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ç”¨<code>setTimeout</code>æ¥æ¨¡æ‹Ÿ<code>import</code>å¼‚æ­¥å¼•å…¥æ•ˆæœã€‚</p>
<p><strong>Test</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) &#123;<br>        <span class="hljs-variable language_">super</span>(props);<br>    &#125;<br>    <span class="hljs-title function_">componentDidMount</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;--componentDidMount--&quot;</span>);<br>    &#125;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&#123;alien&#125;</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;alien&quot;</span> /&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        );<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ•ˆæœ</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bf576c3e03714c1594bfddf2467fe877~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="lazy.gif"></p>
<h2 id="Suspense"><a href="#Suspense" class="headerlink" title="Suspense"></a>Suspense</h2><p>ä½•ä¸º<code>Suspense</code>, <code>Suspense</code> è®©ç»„ä»¶â€œç­‰å¾…â€æŸä¸ªå¼‚æ­¥æ“ä½œï¼Œç›´åˆ°è¯¥å¼‚æ­¥æ“ä½œç»“æŸå³å¯æ¸²æŸ“ã€‚</p>
<p>ç”¨äºæ•°æ®è·å–çš„ <code>Suspense</code> æ˜¯ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>&lt;Suspense&gt;</code> ä»¥å£°æ˜çš„æ–¹å¼æ¥â€œç­‰å¾…â€ä»»ä½•å†…å®¹ï¼ŒåŒ…æ‹¬æ•°æ®ã€‚æœ¬æ–‡é‡ç‚¹ä»‹ç»å®ƒåœ¨æ•°æ®è·å–çš„ç”¨ä¾‹ï¼Œå®ƒä¹Ÿå¯ä»¥ç”¨äºç­‰å¾…å›¾åƒã€è„šæœ¬æˆ–å…¶ä»–å¼‚æ­¥çš„æ“ä½œã€‚</p>
<p>ä¸Šé¢è®²åˆ°é«˜é˜¶ç»„ä»¶<code>lazy</code>æ—¶å€™ï¼Œå·²ç»ç”¨ <code>lazy</code> + <code>Suspense</code>æ¨¡å¼ï¼Œæ„å»ºäº†å¼‚æ­¥æ¸²æŸ“ç»„ä»¶ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹å®˜ç½‘æ–‡æ¡£ä¸­çš„æ¡ˆä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">ProfilePage</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&quot;./ProfilePage&quot;</span>)); <span class="hljs-comment">// æ‡’åŠ è½½</span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">&#123;</span>&lt;<span class="hljs-attr">Spinner</span> /&gt;</span>&#125;&gt;</span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">ProfilePage</span> /&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span>;<br></code></pre></td></tr></table></figure>

<h2 id="Fragment"><a href="#Fragment" class="headerlink" title="Fragment"></a>Fragment</h2><p><code>react</code>ä¸å…è®¸ä¸€ä¸ªç»„ä»¶è¿”å›å¤šä¸ªèŠ‚ç‚¹å…ƒç´ ï¼Œæ¯”å¦‚è¯´å¦‚ä¸‹æƒ…å†µ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">render</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span> ğŸğŸğŸ <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br>           <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span> ğŸŒğŸŒğŸŒ <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br>           <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span> ğŸ‡ğŸ‡ğŸ‡ <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¦‚æœæˆ‘ä»¬æƒ³è§£å†³è¿™ä¸ªæƒ…å†µï¼Œå¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨å¤–å±‚å¥—ä¸€ä¸ªå®¹å™¨å…ƒç´ ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">render</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">           <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span> ğŸğŸğŸ <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">           <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span> ğŸŒğŸŒğŸŒ <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">           <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span> ğŸ‡ğŸ‡ğŸ‡ <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>ä½†æ˜¯æˆ‘ä»¬ä¸æœŸæœ›ï¼Œå¢åŠ é¢å¤–çš„<code>dom</code>èŠ‚ç‚¹ï¼Œæ‰€ä»¥<code>react</code>æä¾›<code>Fragment</code>ç¢ç‰‡æ¦‚å¿µï¼Œèƒ½å¤Ÿè®©ä¸€ä¸ªç»„ä»¶è¿”å›å¤šä¸ªå…ƒç´ ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;<span class="hljs-title class_">React</span>.<span class="hljs-property">Fragment</span>&gt;<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span> ğŸğŸğŸ <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span> ğŸŒğŸŒğŸŒ <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span> ğŸ‡ğŸ‡ğŸ‡ <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br>&lt;/<span class="hljs-title class_">React</span>.<span class="hljs-property">Fragment</span>&gt;<br></code></pre></td></tr></table></figure>

<p>è¿˜å¯ä»¥ç®€å†™æˆï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;&gt;<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span> ğŸğŸğŸ <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span> ğŸŒğŸŒğŸŒ <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span> ğŸ‡ğŸ‡ğŸ‡ <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br>&lt;/&gt;<br></code></pre></td></tr></table></figure>

<p>å’Œ<code>Fragment</code>åŒºåˆ«æ˜¯ï¼Œ<code>Fragment</code>å¯ä»¥æ”¯æŒ<code>key</code>å±æ€§ã€‚<code>&lt;&gt;&lt;/&gt;</code>ä¸æ”¯æŒ<code>key</code>å±æ€§ã€‚</p>
<p><strong>æ¸©é¦¨æç¤º</strong>ã€‚æˆ‘ä»¬é€šè¿‡<code>map</code>éå†åçš„å…ƒç´ ï¼Œ<code>react</code>åº•å±‚ä¼šå¤„ç†ï¼Œé»˜è®¤åœ¨å¤–éƒ¨åµŒå¥—ä¸€ä¸ª<code>&lt;Fragment&gt;</code>ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>    [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>].<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;item.id&#125;</span>&gt;</span>&#123;item.name&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><code>react</code>åº•å±‚å¤„ç†ä¹‹åï¼Œç­‰ä»·äºï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">Fragment</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">Fragment</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h2 id="Profiler"><a href="#Profiler" class="headerlink" title="Profiler"></a>Profiler</h2><p><code>Profiler</code>è¿™ä¸ª<code>api</code>ä¸€èˆ¬ç”¨äºå¼€å‘é˜¶æ®µï¼Œæ€§èƒ½æ£€æµ‹ï¼Œæ£€æµ‹ä¸€æ¬¡<code>react</code>ç»„ä»¶æ¸²æŸ“ç”¨æ—¶ï¼Œæ€§èƒ½å¼€é”€ã€‚</p>
<p><code>Profiler</code> éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼š</p>
<p>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šæ˜¯ <code>id</code>ï¼Œç”¨äºè¡¨è¯†å”¯ä¸€æ€§çš„<code>Profiler</code>ã€‚</p>
<p>ç¬¬äºŒä¸ªå‚æ•°ï¼š<code>onRender</code>å›è°ƒå‡½æ•°ï¼Œç”¨äºæ¸²æŸ“å®Œæˆï¼Œæ¥å—æ¸²æŸ“å‚æ•°ã€‚</p>
<p><strong>å®è·µï¼š</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">index</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">...arg</span>) =&gt; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arg);<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">Profiler</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span> <span class="hljs-attr">onRender</span>=<span class="hljs-string">&#123;callback&#125;</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">Router</span>&gt;</span></span><br><span class="language-xml">                        <span class="hljs-tag">&lt;<span class="hljs-name">Meuns</span> /&gt;</span></span><br><span class="language-xml">                        <span class="hljs-tag">&lt;<span class="hljs-name">KeepaliveRouterSwitch</span> <span class="hljs-attr">withoutRoute</span>&gt;</span></span><br><span class="language-xml">                            &#123;renderRoutes(menusList)&#125;</span><br><span class="language-xml">                        <span class="hljs-tag">&lt;/<span class="hljs-name">KeepaliveRouterSwitch</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">Router</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">Profiler</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;;<br></code></pre></td></tr></table></figure>

<p><strong>ç»“æœ</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/229b794fe0f2449e9a18dc7f3733a395~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="Profiler.jpg"></p>
<p>onRender</p>
<ul>
<li>0 -id: <code>root</code> -&gt; <code>Profiler</code> æ ‘çš„ <code>id</code> ã€‚</li>
<li>1 -phase: <code>mount</code> -&gt; <code>mount</code> æŒ‚è½½ ï¼Œ <code>update</code> æ¸²æŸ“äº†ã€‚</li>
<li>2 -actualDuration: <code>6.685000262223184</code> -&gt; æ›´æ–° <code>committed</code> èŠ±è´¹çš„æ¸²æŸ“æ—¶é—´ã€‚</li>
<li>3 -baseDuration: <code>4.430000321008265</code> -&gt; æ¸²æŸ“æ•´é¢—å­æ ‘éœ€è¦çš„æ—¶é—´</li>
<li>4 -startTime : <code>689.7299999836832</code> -&gt; æœ¬æ¬¡æ›´æ–°å¼€å§‹æ¸²æŸ“çš„æ—¶é—´</li>
<li>5 -commitTime : <code>698.5799999674782</code> -&gt; æœ¬æ¬¡æ›´æ–° committed çš„æ—¶é—´</li>
<li>6 -interactions: <code>set&#123;&#125;</code> -&gt; æœ¬æ¬¡æ›´æ–°çš„ <code>interactions</code> çš„é›†åˆ</li>
</ul>
<blockquote>
<p>å°½ç®¡ Profiler æ˜¯ä¸€ä¸ªè½»é‡çº§ç»„ä»¶ï¼Œæˆ‘ä»¬ä¾ç„¶åº”è¯¥åœ¨éœ€è¦æ—¶æ‰å»ä½¿ç”¨å®ƒã€‚å¯¹ä¸€ä¸ªåº”ç”¨æ¥è¯´ï¼Œæ¯æ·»åŠ ä¸€äº›éƒ½ä¼šç»™ CPU å’Œå†…å­˜å¸¦æ¥ä¸€äº›è´Ÿæ‹…ã€‚</p>
</blockquote>
<h2 id="StrictMode"><a href="#StrictMode" class="headerlink" title="StrictMode"></a>StrictMode</h2><p><code>StrictMode</code>è§åçŸ¥æ„ï¼Œä¸¥æ ¼æ¨¡å¼ï¼Œç”¨äºæ£€æµ‹<code>react</code>é¡¹ç›®ä¸­çš„æ½œåœ¨çš„é—®é¢˜ï¼Œã€‚ä¸ <code>Fragment</code> ä¸€æ ·ï¼Œ <code>StrictMode</code> ä¸ä¼šæ¸²æŸ“ä»»ä½•å¯è§çš„ <code>UI</code> ã€‚å®ƒä¸ºå…¶åä»£å…ƒç´ è§¦å‘é¢å¤–çš„æ£€æŸ¥å’Œè­¦å‘Šã€‚</p>
<blockquote>
<p>ä¸¥æ ¼æ¨¡å¼æ£€æŸ¥ä»…åœ¨å¼€å‘æ¨¡å¼ä¸‹è¿è¡Œï¼›å®ƒä»¬ä¸ä¼šå½±å“ç”Ÿäº§æ„å»ºã€‚</p>
</blockquote>
<p><code>StrictMode</code>ç›®å‰æœ‰åŠ©äºï¼š</p>
<ul>
<li>â‘  è¯†åˆ«ä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸã€‚</li>
<li>â‘¡ å…³äºä½¿ç”¨è¿‡æ—¶å­—ç¬¦ä¸² <code>ref API</code> çš„è­¦å‘Š</li>
<li>â‘¢ å…³äºä½¿ç”¨åºŸå¼ƒçš„ <code>findDOMNode</code> æ–¹æ³•çš„è­¦å‘Š</li>
<li>â‘£ æ£€æµ‹æ„å¤–çš„å‰¯ä½œç”¨</li>
<li>â‘¤ æ£€æµ‹è¿‡æ—¶çš„ <code>context API</code></li>
</ul>
<p><strong>å®è·µ:è¯†åˆ«ä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸ</strong></p>
<p>å¯¹äºä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸï¼ŒæŒ‡çš„æ˜¯<code>UNSAFE_componentWillMount</code>ï¼Œ<code>UNSAFE_componentWillReceiveProps</code> , <code>UNSAFE_componentWillUpdate</code></p>
<p><code>å¤–å±‚å¼€å¯ä¸¥æ ¼æ¨¡å¼ï¼š</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;<span class="hljs-title class_">React</span>.<span class="hljs-property">StrictMode</span>&gt;<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Router</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">Meuns</span> /&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">KeepaliveRouterSwitch</span> <span class="hljs-attr">withoutRoute</span>&gt;</span></span><br><span class="language-xml">            &#123;renderRoutes(menusList)&#125;</span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">KeepaliveRouterSwitch</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">Router</span>&gt;</span></span><br>&lt;/<span class="hljs-title class_">React</span>.<span class="hljs-property">StrictMode</span>&gt;<br></code></pre></td></tr></table></figure>

<p><code>æˆ‘ä»¬åœ¨å†…å±‚ç»„ä»¶ä¸­ï¼Œä½¿ç”¨ä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸ:</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    <span class="hljs-title function_">UNSAFE_componentWillReceiveProps</span>(<span class="hljs-params"></span>) &#123;&#125;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;box&quot;</span> /&gt;</span></span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><code>æ•ˆæœï¼š</code></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5c84f768c1d440ccb4523d51a7065b79~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="strictMode.jpg"></p>
<h1 id="å·¥å…·ç±»"><a href="#å·¥å…·ç±»" class="headerlink" title="å·¥å…·ç±»"></a>å·¥å…·ç±»</h1><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä¸€èµ·æ¥æ¢ç©¶ä¸€ä¸‹<code>react</code>å·¥å…·ç±»å‡½æ•°çš„ç”¨æ³•ã€‚</p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4a55db52d97845b2bc29d9078680ef82~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="utils.jpg"></p>
<h2 id="createElement"><a href="#createElement" class="headerlink" title="createElement"></a>createElement</h2><p>ä¸€æåˆ°<code>createElement</code>ï¼Œå°±ä¸ç”±å¾—å’Œ<code>JSX</code>è”ç³»ä¸€èµ·ã€‚æˆ‘ä»¬å†™çš„<code>jsx</code>ï¼Œæœ€ç»ˆä¼šè¢« <code>babel</code>ï¼Œç”¨<code>createElement</code>ç¼–è¯‘æˆ<code>react</code>å…ƒç´ å½¢å¼ã€‚æˆ‘å†™ä¸€ä¸ªç»„ä»¶ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ä¼šè¢«ç¼–è¯‘æˆä»€ä¹ˆæ ·å­ï¼Œ</p>
<p>å¦‚æœæˆ‘ä»¬åœ¨<code>render</code>é‡Œé¢è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">render</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;box&quot;</span> &gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;item&quot;</span>  &gt;</span>ç”Ÿå‘½å‘¨æœŸ<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">Text</span>  <span class="hljs-attr">mes</span>=<span class="hljs-string">&quot;hello,world&quot;</span>  /&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">React.Fragment</span>&gt;</span> Flagment <span class="hljs-tag">&lt;/<span class="hljs-name">React.Fragment</span>&gt;</span></span><br><span class="language-xml">        &#123; /*  */ &#125;</span><br><span class="language-xml">        textæ–‡æœ¬</span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>ä¼šè¢«ç¼–è¯‘æˆè¿™æ ·ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;div&quot;</span>, &#123; <span class="hljs-attr">className</span>: <span class="hljs-string">&quot;box&quot;</span> &#125;,<br>            <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;div&quot;</span>, &#123; <span class="hljs-attr">className</span>: <span class="hljs-string">&quot;item&quot;</span> &#125;, <span class="hljs-string">&quot;\u751F\u547D\u5468\u671F&quot;</span>),<br>            <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-title class_">Text</span>, &#123; <span class="hljs-attr">mes</span>: <span class="hljs-string">&quot;hello,world&quot;</span> &#125;),<br>            <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-title class_">React</span>.<span class="hljs-property">Fragment</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">&quot; Flagment &quot;</span>),<br>            <span class="hljs-string">&quot;text\u6587\u672C&quot;</span>);<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>å½“ç„¶æˆ‘ä»¬å¯ä»¥ä¸ç”¨<code>jsx</code>æ¨¡å¼ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡<code>createElement</code>è¿›è¡Œå¼€å‘ã€‚</p>
<p><strong><code>createElement</code>æ¨¡å‹:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">React</span>.<span class="hljs-title function_">createElement</span>(type, [props], [...children]);<br></code></pre></td></tr></table></figure>

<p><code>createElement</code>å‚æ•°ï¼š</p>
<p>**ç¬¬ä¸€ä¸ªå‚æ•°:**å¦‚æœæ˜¯ç»„ä»¶ç±»å‹ï¼Œä¼šä¼ å…¥ç»„ä»¶ï¼Œå¦‚æœæ˜¯<code>dom</code>å…ƒç´ ç±»å‹ï¼Œä¼ å…¥<code>div</code>æˆ–è€…<code>span</code>ä¹‹ç±»çš„å­—ç¬¦ä¸²ã€‚</p>
<p><strong>ç¬¬äºŒä¸ªå‚æ•°:</strong>:ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨<code>dom</code>ç±»å‹ä¸­ä¸º<strong>å±æ€§</strong>ï¼Œåœ¨<code>ç»„ä»¶</code>ç±»å‹ä¸­ä¸º<strong>props</strong>ã€‚</p>
<p>**å…¶ä»–å‚æ•°:**ï¼Œä¾æ¬¡ä¸º<code>children</code>ï¼Œæ ¹æ®é¡ºåºæ’åˆ—ã€‚</p>
<p><strong>createElement åšäº†äº›ä»€ä¹ˆï¼Ÿ</strong></p>
<p>ç»è¿‡<code>createElement</code>å¤„ç†ï¼Œæœ€ç»ˆä¼šå½¢æˆ <code>$$typeof = Symbol(react.element)</code>å¯¹è±¡ã€‚å¯¹è±¡ä¸Šä¿å­˜äº†è¯¥<code>react.element</code>çš„ä¿¡æ¯ã€‚</p>
<h2 id="cloneElement"><a href="#cloneElement" class="headerlink" title="cloneElement"></a>cloneElement</h2><p>å¯èƒ½æœ‰çš„åŒå­¦è¿˜å‚»å‚»çš„åˆ†ä¸æ¸…æ¥š<code>cloneElement</code>å’Œ<code>createElement</code>åŒºåˆ«å’Œä½œç”¨ã€‚</p>
<p><code>createElement</code>æŠŠæˆ‘ä»¬å†™çš„<code>jsx</code>ï¼Œå˜æˆ<code>element</code>å¯¹è±¡; è€Œ<code>cloneElement</code>çš„ä½œç”¨æ˜¯ä»¥ <code>element</code> å…ƒç´ ä¸ºæ ·æ¿å…‹éš†å¹¶è¿”å›æ–°çš„ <code>React</code> å…ƒç´ ã€‚è¿”å›å…ƒç´ çš„ <code>props</code> æ˜¯å°†æ–°çš„ <code>props</code> ä¸åŸå§‹å…ƒç´ çš„ <code>props</code> æµ…å±‚åˆå¹¶åçš„ç»“æœã€‚</p>
<p>é‚£ä¹ˆ<code>cloneElement</code>æ„Ÿè§‰åœ¨æˆ‘ä»¬å®é™…ä¸šåŠ¡ç»„ä»¶ä¸­ï¼Œå¯èƒ½æ²¡ä»€ä¹ˆç”¨ï¼Œä½†æ˜¯åœ¨<strong>ä¸€äº›å¼€æºé¡¹ç›®ï¼Œæˆ–è€…æ˜¯å…¬å…±æ’æ§½ç»„ä»¶ä¸­</strong>ç”¨å¤„è¿˜æ˜¯è›®å¤§çš„ï¼Œæ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç»„ä»¶ä¸­ï¼ŒåŠ«æŒ<code>children element</code>ï¼Œç„¶åé€šè¿‡<code>cloneElement</code>å…‹éš†<code>element</code>ï¼Œæ··å…¥<code>props</code>ã€‚ç»å…¸çš„æ¡ˆä¾‹å°±æ˜¯ <code>react-router</code>ä¸­çš„<code>Swtich</code>ç»„ä»¶ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ¥åŒ¹é…å”¯ä¸€çš„ <code>Route</code>å¹¶åŠ ä»¥æ¸²æŸ“ã€‚</p>
<p>æˆ‘ä»¬è®¾ç½®ä¸€ä¸ªåœºæ™¯ï¼Œåœ¨ç»„ä»¶ä¸­ï¼Œå»åŠ«æŒ<code>children</code>ï¼Œç„¶åç»™<code>children</code>èµ‹èƒ½ä¸€äº›é¢å¤–çš„<code>props</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">FatherComponent</span>(<span class="hljs-params">&#123; children &#125;</span>) &#123;<br>    <span class="hljs-keyword">const</span> newChildren = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">cloneElement</span>(children, &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">18</span> &#125;);<br>    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span> &#123;newChildren&#125; <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">SonComponent</span>(<span class="hljs-params">props</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(props);<br>    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>hello,world<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;box&quot;</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">FatherComponent</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">SonComponent</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;alien&quot;</span> /&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">FatherComponent</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        );<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ‰“å°ï¼š</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8d4b0529cbea4e25bfcf1168d6e6d7b6~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="cloneElment.jpg"></p>
<p>å®Œç¾è¾¾åˆ°äº†æ•ˆæœï¼</p>
<h2 id="createContext"><a href="#createContext" class="headerlink" title="createContext"></a>createContext</h2><p><code>createContext</code>ç”¨äºåˆ›å»ºä¸€ä¸ª<code>Context</code>å¯¹è±¡ï¼Œ<code>createContext</code>å¯¹è±¡ä¸­ï¼ŒåŒ…æ‹¬ç”¨äºä¼ é€’ <code>Context</code> å¯¹è±¡å€¼ <code>value</code>çš„<code>Provider</code>ï¼Œå’Œæ¥å—<code>value</code>å˜åŒ–è®¢é˜…çš„<code>Consumer</code>ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">MyContext</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createContext</span>(defaultValue);<br></code></pre></td></tr></table></figure>

<p><code>createContext</code>æ¥å—ä¸€ä¸ªå‚æ•°<code>defaultValue</code>ï¼Œå¦‚æœ<code>Consumer</code>ä¸Šä¸€çº§ä¸€ç›´æ²¡æœ‰<code>Provider</code>,åˆ™ä¼šåº”ç”¨<code>defaultValue</code>ä½œä¸º<code>value</code>ã€‚<strong>åªæœ‰</strong>å½“ç»„ä»¶æ‰€å¤„çš„æ ‘ä¸­æ²¡æœ‰åŒ¹é…åˆ° <code>Provider</code> æ—¶ï¼Œå…¶ <code>defaultValue</code> å‚æ•°æ‰ä¼šç”Ÿæ•ˆã€‚</p>
<p>æˆ‘ä»¬æ¥æ¨¡æ‹Ÿä¸€ä¸ª <code>Context.Provider</code>å’Œ<code>Context.Consumer</code>çš„ä¾‹å­ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">ComponentB</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">/* ç”¨ Consumer è®¢é˜…ï¼Œ æ¥è‡ª Provider ä¸­ value çš„æ”¹å˜  */</span><br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">MyContext.Consumer</span>&gt;</span></span><br><span class="language-xml">            &#123;(value) =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">ComponentA</span> &#123;<span class="hljs-attr">...value</span>&#125; /&gt;</span>&#125;</span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">MyContext.Consumer</span>&gt;</span></span><br>    );<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">ComponentA</span>(<span class="hljs-params">props</span>) &#123;<br>    <span class="hljs-keyword">const</span> &#123; name, mes &#125; = props;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span> å§“åï¼š &#123;name&#125; <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span> æƒ³å¯¹å¤§å®¶è¯´ï¼š &#123;mes&#125; <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">index</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">const</span> [value] = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useState</span>(&#123;<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;alien&quot;</span>,<br>        <span class="hljs-attr">mes</span>: <span class="hljs-string">&quot;let us learn React &quot;</span>,<br>    &#125;);<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">marginTop:</span> &quot;<span class="hljs-attr">50px</span>&quot; &#125;&#125;&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">MyContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;value&#125;</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ComponentB</span> /&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">MyContext.Provider</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ‰“å°ç»“æœï¼š</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4393bac1d6b2428d9365b0f3ff480419~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="createContent.jpg"></p>
<p><code>Provider</code>å’Œ<code>Consumer</code>çš„è‰¯å¥½çš„ç‰¹æ€§ï¼Œå¯ä»¥åšæ•°æ®çš„<strong>å­˜</strong>å’Œ<strong>å–</strong>ï¼Œ<code>Consumer</code>ä¸€æ–¹é¢ä¼ é€’<code>value</code>,å¦ä¸€æ–¹é¢å¯ä»¥è®¢é˜…<code>value</code>çš„æ”¹å˜ã€‚</p>
<p><code>Provider</code>è¿˜æœ‰ä¸€ä¸ªç‰¹æ€§å¯ä»¥å±‚å±‚ä¼ é€’<code>value</code>ï¼Œè¿™ç§ç‰¹æ€§åœ¨<code>react-redux</code>ä¸­è¡¨ç°çš„æ·‹æ¼“å°½è‡´ã€‚</p>
<h2 id="createFactory"><a href="#createFactory" class="headerlink" title="createFactory"></a>createFactory</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">React</span>.<span class="hljs-title function_">createFactory</span>(type);<br></code></pre></td></tr></table></figure>

<p>è¿”å›ç”¨äºç”ŸæˆæŒ‡å®šç±»å‹ React å…ƒç´ çš„å‡½æ•°ã€‚ç±»å‹å‚æ•°æ—¢å¯ä»¥æ˜¯æ ‡ç­¾åå­—ç¬¦ä¸²ï¼ˆåƒæ˜¯ â€˜<code>div</code>â€˜ æˆ– â€˜<code>span</code>â€˜ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯ React ç»„ä»¶ ç±»å‹ ï¼ˆ <code>class</code> ç»„ä»¶æˆ–å‡½æ•°ç»„ä»¶ï¼‰ï¼Œæˆ–æ˜¯ <code>React fragment</code> ç±»å‹ã€‚</p>
<p>ä½¿ç”¨ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Text</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createFactory</span>(<span class="hljs-function">() =&gt;</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>hello,world<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>);<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Index</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">marginTop:</span> &quot;<span class="hljs-attr">50px</span>&quot; &#125;&#125;&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> /&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ•ˆæœ</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9984deb7d57d42fd8661c4c14ea19d72~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="createFactory.jpg"></p>
<p>æŠ¥å‡ºè­¦å‘Šï¼Œè¿™ä¸ª<code>api</code>å°†è¦è¢«åºŸå¼ƒï¼Œæˆ‘ä»¬è¿™é‡Œå°±ä¸å¤šè®²äº†ï¼Œå¦‚æœæƒ³è¦è¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼Œè¯·ç”¨<code>React.createElement</code></p>
<h2 id="createRef"><a href="#createRef" class="headerlink" title="createRef"></a>createRef</h2><p><code>createRef</code>å¯ä»¥åˆ›å»ºä¸€ä¸ª <code>ref</code> å…ƒç´ ï¼Œé™„åŠ åœ¨<code>react</code>å…ƒç´ ä¸Šã€‚</p>
<p><strong>ç”¨æ³•ï¼š</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) &#123;<br>        <span class="hljs-variable language_">super</span>(props);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">node</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createRef</span>();<br>    &#125;<br>    <span class="hljs-title function_">componentDidMount</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">node</span>);<br>    &#125;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;this.node&#125;</span>&gt;</span> my name is alien <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ä¸ªäººè§‰å¾—<code>createRef</code>è¿™ä¸ªæ–¹æ³•ï¼Œå¾ˆé¸¡è‚‹ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥<code>class</code>ç±»ç»„ä»¶ä¸­è¿™ä¹ˆå†™ï¼Œæ¥æ•è·<code>ref</code>ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    node = <span class="hljs-literal">null</span>;<br>    <span class="hljs-title function_">componentDidMount</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">node</span>);<br>    &#125;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;(node)</span> =&gt;</span> this.node&#125;&gt; my name is alien <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æˆ–è€…åœ¨<code>function</code>ç»„ä»¶ä¸­è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Index</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">const</span> node = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);<br>    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(node.<span class="hljs-property">current</span>);<br>    &#125;, []);<br>    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;node&#125;</span>&gt;</span> my name is alien <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="isValidElement"><a href="#isValidElement" class="headerlink" title="isValidElement"></a>isValidElement</h2><p>è¿™ä¸ªæ–¹æ³•å¯ä»¥ç”¨æ¥æ£€æµ‹æ˜¯å¦ä¸º<code>react element</code>å…ƒç´ ,æ¥å—å¾…éªŒè¯å¯¹è±¡ï¼Œè¿”å›<code>true</code>æˆ–è€…<code>false</code>ã€‚è¿™ä¸ª api å¯èƒ½å¯¹äºä¸šåŠ¡ç»„ä»¶çš„å¼€å‘ï¼Œä½œç”¨ä¸å¤§ï¼Œå› ä¸ºå¯¹äºç»„ä»¶å†…éƒ¨çŠ¶æ€ï¼Œéƒ½æ˜¯å·²çŸ¥çš„ï¼Œæˆ‘ä»¬æ ¹æœ¬å°±ä¸éœ€è¦å»éªŒè¯ï¼Œæ˜¯å¦æ˜¯<code>react element</code> å…ƒç´ ã€‚ ä½†æ˜¯ï¼Œå¯¹äºä¸€èµ·å…¬å…±ç»„ä»¶æˆ–æ˜¯å¼€æºåº“ï¼Œ<code>isValidElement</code>å°±å¾ˆæœ‰ä½œç”¨äº†ã€‚</p>
<p><strong>å®è·µ</strong></p>
<p>æˆ‘ä»¬åšä¸€ä¸ªåœºæ™¯ï¼ŒéªŒè¯å®¹å™¨ç»„ä»¶çš„æ‰€æœ‰å­ç»„ä»¶ï¼Œè¿‡æ»¤åˆ°é<code>react element</code>ç±»å‹ã€‚</p>
<p>æ²¡æœ‰ç”¨<code>isValidElement</code>éªŒè¯ä¹‹å‰ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">Text</span> = (<span class="hljs-params"></span>) =&gt; <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>hello,world<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">WarpComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) &#123;<br>        <span class="hljs-variable language_">super</span>(props);<br>    &#125;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>.<span class="hljs-property">children</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Index</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">marginTop:</span> &quot;<span class="hljs-attr">50px</span>&quot; &#125;&#125;&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">WarpComponent</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> /&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span> my name is alien <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                Let&#x27;s learn react together!</span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">WarpComponent</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>è¿‡æ»¤ä¹‹å‰çš„æ•ˆæœ</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dfad646de7b3453bbb2c3d66c635f13b~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="isValidElement.jpg"></p>
<p><strong>æˆ‘ä»¬ç”¨<code>isValidElement</code>è¿›è¡Œ<code>react element</code>éªŒè¯:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">WarpComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) &#123;<br>        <span class="hljs-variable language_">super</span>(props);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">newChidren</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>.<span class="hljs-property">children</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span><br>            <span class="hljs-title class_">React</span>.<span class="hljs-title function_">isValidElement</span>(item)<br>        );<br>    &#125;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">newChidren</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>è¿‡æ»¤ä¹‹åæ•ˆæœ</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b7ef80c8874c4a509c74fefd8b1e4e05~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="isValidElement111.jpg"></p>
<p>è¿‡æ»¤æ‰äº†é<code>react element</code> çš„ <code>Let&#39;s learn react together!</code>ã€‚</p>
<h2 id="Children-map"><a href="#Children-map" class="headerlink" title="Children.map"></a>Children.map</h2><p>æ¥ä¸‹æ¥çš„äº”ä¸ª<code>api</code>éƒ½æ˜¯å’Œ<code>react.Chidren</code>ç›¸å…³çš„ï¼Œæˆ‘ä»¬æ¥åˆ†åˆ«ä»‹ç»ä¸€ä¸‹ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å®˜ç½‘çš„æè¿°ï¼Œ<code>React.Children</code> æä¾›äº†ç”¨äºå¤„ç† <code>this.props.children</code> ä¸é€æ˜æ•°æ®ç»“æ„çš„å®ç”¨æ–¹æ³•ã€‚</p>
<p>æœ‰çš„åŒå­¦ä¼šé—®éå† <code>children</code>ç”¨æ•°ç»„æ–¹æ³•,<code>map</code> ï¼Œ<code>forEach</code> ä¸å°±å¯ä»¥äº†å—ï¼Ÿ è¯·æˆ‘ä»¬æ³¨æ„ä¸€ä¸‹<code>ä¸é€æ˜æ•°æ®ç»“æ„</code>,ä»€ä¹ˆå«åšä¸é€æ˜ç»“æ„?</p>
<p><strong>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹é€æ˜çš„ç»“æ„ï¼š</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Text</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>hello,world<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">WarpComponent</span>(<span class="hljs-params">props</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(props.<span class="hljs-property">children</span>);<br>    <span class="hljs-keyword">return</span> props.<span class="hljs-property">children</span>;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Index</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">marginTop:</span> &quot;<span class="hljs-attr">50px</span>&quot; &#125;&#125;&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">WarpComponent</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> /&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> /&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> /&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>hello,world<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">WarpComponent</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ‰“å°</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4247073612eb4b609a1ca7528a1a07f1~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="chidrenmap.jpg"></p>
<p>ä½†æ˜¯æˆ‘ä»¬æŠŠ<code>Index</code>ç»“æ„æ”¹å˜ä¸€ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Index</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">marginTop:</span> &quot;<span class="hljs-attr">50px</span>&quot; &#125;&#125;&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">WarpComponent</span>&gt;</span></span><br><span class="language-xml">                &#123;new Array(3).fill(0).map(() =&gt; (</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> /&gt;</span></span><br><span class="language-xml">                ))&#125;</span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>hello,world<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">WarpComponent</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ‰“å°</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b8e1630e79f54b54b4291b7f4130aebe~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="chidrenmap2.jpg"></p>
<p>è¿™ä¸ªæ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬ä¸èƒ½æ­£å¸¸çš„éå†äº†ï¼Œå³ä½¿éå†ä¹Ÿä¸èƒ½éå†ï¼Œæ¯ä¸€ä¸ªå­å…ƒç´ ã€‚æ­¤æ—¶å°±éœ€è¦ <code>react.Chidren</code> æ¥å¸®å¿™äº†ã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬æŠŠ<code>WarpComponent</code>ç»„ä»¶ç”¨<code>react.Chidren</code>å¤„ç†<code>children</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">WarpComponent</span>(<span class="hljs-params">props</span>) &#123;<br>    <span class="hljs-keyword">const</span> newChildren = <span class="hljs-title class_">React</span>.<span class="hljs-property">Children</span>.<span class="hljs-title function_">map</span>(props.<span class="hljs-property">children</span>, <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(newChildren);<br>    <span class="hljs-keyword">return</span> newChildren;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æ­¤æ—¶å°±èƒ½æ­£å¸¸éå†äº†ï¼Œè¾¾åˆ°äº†é¢„æœŸæ•ˆæœã€‚</p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0158172495a648df8e804a0707f993bc~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="C71364B2-25E8-4F7D-A26D-50CA36AF4E33.jpg"></p>
<p><strong>æ³¨æ„</strong> å¦‚æœ <code>children</code> æ˜¯ä¸€ä¸ª <code>Fragment</code> å¯¹è±¡ï¼Œå®ƒå°†è¢«è§†ä¸ºå•ä¸€å­èŠ‚ç‚¹çš„æƒ…å†µå¤„ç†ï¼Œè€Œä¸ä¼šè¢«éå†ã€‚</p>
<h2 id="Children-forEach"><a href="#Children-forEach" class="headerlink" title="Children.forEach"></a>Children.forEach</h2><p><code>Children.forEach</code>å’Œ<code>Children.map</code> ç”¨æ³•ç±»ä¼¼ï¼Œ<code>Children.map</code>å¯ä»¥è¿”å›æ–°çš„æ•°ç»„ï¼Œ<code>Children.forEach</code>ä»…åœç•™åœ¨éå†é˜¶æ®µã€‚</p>
<p>æˆ‘ä»¬å°†ä¸Šé¢çš„<code>WarpComponent</code>æ–¹æ³•ï¼Œç”¨<code>Children.forEach</code>æ”¹ä¸€ä¸‹ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">WarpComponent</span>(<span class="hljs-params">props</span>) &#123;<br>    <span class="hljs-title class_">React</span>.<span class="hljs-property">Children</span>.<span class="hljs-title function_">forEach</span>(props.<span class="hljs-property">children</span>, <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(item));<br>    <span class="hljs-keyword">return</span> props.<span class="hljs-property">children</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Children-count"><a href="#Children-count" class="headerlink" title="Children.count"></a>Children.count</h2><p><code>children</code> ä¸­çš„ç»„ä»¶æ€»æ•°é‡ï¼Œç­‰åŒäºé€šè¿‡ <code>map</code> æˆ– <code>forEach</code> è°ƒç”¨å›è°ƒå‡½æ•°çš„æ¬¡æ•°ã€‚å¯¹äºæ›´å¤æ‚çš„ç»“æœï¼Œ<code>Children.count</code>å¯ä»¥è¿”å›åŒä¸€çº§åˆ«å­ç»„ä»¶çš„æ•°é‡ã€‚</p>
<p>æˆ‘ä»¬è¿˜æ˜¯æŠŠä¸Šè¿°ä¾‹å­è¿›è¡Œæ”¹é€ ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">WarpComponent</span>(<span class="hljs-params">props</span>) &#123;<br>    <span class="hljs-keyword">const</span> childrenCount = <span class="hljs-title class_">React</span>.<span class="hljs-property">Children</span>.<span class="hljs-title function_">count</span>(props.<span class="hljs-property">children</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(childrenCount, <span class="hljs-string">&quot;childrenCount&quot;</span>);<br>    <span class="hljs-keyword">return</span> props.<span class="hljs-property">children</span>;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Index</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">marginTop:</span> &quot;<span class="hljs-attr">50px</span>&quot; &#125;&#125;&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">WarpComponent</span>&gt;</span></span><br><span class="language-xml">                &#123;new Array(3)</span><br><span class="language-xml">                    .fill(0)</span><br><span class="language-xml">                    .map((item, index) =&gt;</span><br><span class="language-xml">                        new Array(2)</span><br><span class="language-xml">                            .fill(1)</span><br><span class="language-xml">                            .map((item, index1) =&gt; (</span><br><span class="language-xml">                                <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;index</span> + <span class="hljs-attr">index1</span>&#125; /&gt;</span></span><br><span class="language-xml">                            ))</span><br><span class="language-xml">                    )&#125;</span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>hello,world<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">WarpComponent</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ•ˆæœ:</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/04f10179d259460884beb8f035fa15e4~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="chidrencunt.jpg"></p>
<h2 id="Children-toArray"><a href="#Children-toArray" class="headerlink" title="Children.toArray"></a>Children.toArray</h2><p><code>Children.toArray</code>è¿”å›ï¼Œ<code>props.children</code>æ‰å¹³åŒ–åç»“æœã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">WarpComponent</span>(<span class="hljs-params">props</span>) &#123;<br>    <span class="hljs-keyword">const</span> newChidrenArray = <span class="hljs-title class_">React</span>.<span class="hljs-property">Children</span>.<span class="hljs-title function_">toArray</span>(props.<span class="hljs-property">children</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(newChidrenArray, <span class="hljs-string">&quot;newChidrenArray&quot;</span>);<br>    <span class="hljs-keyword">return</span> newChidrenArray;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Index</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">marginTop:</span> &quot;<span class="hljs-attr">50px</span>&quot; &#125;&#125;&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">WarpComponent</span>&gt;</span></span><br><span class="language-xml">                &#123;new Array(3)</span><br><span class="language-xml">                    .fill(0)</span><br><span class="language-xml">                    .map((item, index) =&gt;</span><br><span class="language-xml">                        new Array(2)</span><br><span class="language-xml">                            .fill(1)</span><br><span class="language-xml">                            .map((item, index1) =&gt; (</span><br><span class="language-xml">                                <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;index</span> + <span class="hljs-attr">index1</span>&#125; /&gt;</span></span><br><span class="language-xml">                            ))</span><br><span class="language-xml">                    )&#125;</span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>hello,world<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">WarpComponent</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ•ˆæœï¼š</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/64a4a789f44747ba93fa54bc94fa7f8b~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="chuldeanarrgy.jpg"></p>
<p><strong>newChidrenArray</strong> ,å°±æ˜¯æ‰å¹³åŒ–çš„æ•°ç»„ç»“æ„ã€‚<code>React.Children.toArray()</code> åœ¨æ‹‰å¹³å±•å¼€å­èŠ‚ç‚¹åˆ—è¡¨æ—¶ï¼Œæ›´æ”¹ <code>key</code> å€¼ä»¥ä¿ç•™åµŒå¥—æ•°ç»„çš„è¯­ä¹‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ <code>toArray</code> ä¼šä¸ºè¿”å›æ•°ç»„ä¸­çš„æ¯ä¸ª <code>key</code> æ·»åŠ å‰ç¼€ï¼Œä»¥ä½¿å¾—æ¯ä¸ªå…ƒç´  <code>key</code> çš„èŒƒå›´éƒ½é™å®šåœ¨æ­¤å‡½æ•°å…¥å‚æ•°ç»„çš„å¯¹è±¡å†…ã€‚</p>
<h2 id="Children-only"><a href="#Children-only" class="headerlink" title="Children.only"></a>Children.only</h2><p>éªŒè¯ <code>children</code> æ˜¯å¦åªæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹ï¼ˆä¸€ä¸ª <code>React</code> å…ƒç´ ï¼‰ï¼Œå¦‚æœæœ‰åˆ™è¿”å›å®ƒï¼Œå¦åˆ™æ­¤æ–¹æ³•ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p>
<p><strong>ä¸å”¯ä¸€</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">WarpComponent</span>(<span class="hljs-params">props</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">React</span>.<span class="hljs-property">Children</span>.<span class="hljs-title function_">only</span>(props.<span class="hljs-property">children</span>));<br>    <span class="hljs-keyword">return</span> props.<span class="hljs-property">children</span>;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Index</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">marginTop:</span> &quot;<span class="hljs-attr">50px</span>&quot; &#125;&#125;&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">WarpComponent</span>&gt;</span></span><br><span class="language-xml">                &#123;new Array(3).fill(0).map((item, index) =&gt; (</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;index&#125;</span> /&gt;</span></span><br><span class="language-xml">                ))&#125;</span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>hello,world<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">WarpComponent</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ•ˆæœ</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a16924238b9042739100e51034e5f810~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="falseonly.jpg"></p>
<p><strong>å”¯ä¸€</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">WarpComponent</span>(<span class="hljs-params">props</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">React</span>.<span class="hljs-property">Children</span>.<span class="hljs-title function_">only</span>(props.<span class="hljs-property">children</span>));<br>    <span class="hljs-keyword">return</span> props.<span class="hljs-property">children</span>;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Index</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">marginTop:</span> &quot;<span class="hljs-attr">50px</span>&quot; &#125;&#125;&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">WarpComponent</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> /&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">WarpComponent</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ•ˆæœ</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/05aa09a275e6472a8ce50ec58e29a8ab~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="only.jpg"></p>
<p><code>React.Children.only()</code> ä¸æ¥å— <code>React.Children.map()</code> çš„è¿”å›å€¼ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªæ•°ç»„è€Œå¹¶ä¸æ˜¯ <code>React</code> å…ƒç´ ã€‚</p>
<h1 id="react-hooks"><a href="#react-hooks" class="headerlink" title="react-hooks"></a>react-hooks</h1><p>å¯¹äº<code>react-hooks</code>,æˆ‘å·²ç»å†™äº†ä¸‰éƒ¨æ›²ï¼Œä»‹ç»äº†<code>react-hooks</code>ä½¿ç”¨ï¼Œè‡ªå®šä¹‰<code>hooks</code>ï¼Œä»¥åŠ<code>react-hooks</code>åŸç†ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å»çœ‹çœ‹ï¼Œæ–‡ç« æœ«å°¾æœ‰é“¾æ¥ï¼Œå¯¹äºå¸¸ç”¨çš„<code>api</code>ï¼Œæˆ‘è¿™é‡Œå‚è€ƒäº†<code>react-hooks</code>å¦‚ä½•ä½¿ç”¨é‚£ç¯‡æ–‡ç« ã€‚å¹¶åšäº†ç›¸åº”ç²¾ç®€åŒ–å’Œä¸€äº›å†…å®¹çš„è¡¥å……ã€‚</p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/978f814d97e441838bad1d654ba1ef42~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="hooks.jpg"></p>
<h2 id="useState"><a href="#useState" class="headerlink" title="useState"></a>useState</h2><p><code>useState</code>å¯ä»¥å¼¥è¡¥å‡½æ•°ç»„ä»¶æ²¡æœ‰<code>state</code>çš„ç¼ºé™·ã€‚<code>useState</code>å¯ä»¥æ¥å—ä¸€ä¸ªåˆè¯†å€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°<code>action</code>ï¼Œ<code>action</code>è¿”å›å€¼ä½œä¸ºæ–°çš„<code>state</code>ã€‚è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå€¼ä¸º<code>state</code>è¯»å–å€¼ï¼Œç¬¬äºŒä¸ªå€¼ä¸ºæ”¹å˜<code>state</code>çš„<code>dispatchAction</code>å‡½æ•°ã€‚</p>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> <span class="hljs-title function_">DemoState</span> = (<span class="hljs-params">props</span>) =&gt; &#123;<br>    <span class="hljs-comment">/* numberä¸ºæ­¤æ—¶stateè¯»å–å€¼ ï¼ŒsetNumberä¸ºæ´¾å‘æ›´æ–°çš„å‡½æ•° */</span><br>    <span class="hljs-keyword">let</span> [number, setNumber] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>); <span class="hljs-comment">/* 0ä¸ºåˆå§‹å€¼ */</span><br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#123;number&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> &#123;</span><br><span class="language-xml">                    setNumber(number + 1); /* å†™æ³•ä¸€ */</span><br><span class="language-xml">                    setNumber((number) =&gt; number + 1); /* å†™æ³•äºŒ */</span><br><span class="language-xml">                    console.log(number); /* è¿™é‡Œçš„numberæ˜¯ä¸èƒ½å¤Ÿå³æ—¶æ”¹å˜çš„  */</span><br><span class="language-xml">                &#125;&#125;</span><br><span class="language-xml">            &gt;</span><br><span class="language-xml">                num++</span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;;<br></code></pre></td></tr></table></figure>

<h2 id="useEffect"><a href="#useEffect" class="headerlink" title="useEffect"></a>useEffect</h2><p><code>useEffect</code>å¯ä»¥å¼¥è¡¥å‡½æ•°ç»„ä»¶æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸçš„ç¼ºç‚¹ã€‚æˆ‘ä»¬å¯ä»¥åœ¨<code>useEffect</code>ç¬¬ä¸€ä¸ªå‚æ•°å›è°ƒå‡½æ•°ä¸­ï¼Œåšä¸€äº›è¯·æ±‚æ•°æ®ï¼Œäº‹ä»¶ç›‘å¬ç­‰æ“ä½œï¼Œç¬¬äºŒä¸ªå‚æ•°ä½œä¸º<code>dep</code>ä¾èµ–é¡¹ï¼Œå½“ä¾èµ–é¡¹å‘ç”Ÿå˜åŒ–ï¼Œé‡æ–°æ‰§è¡Œç¬¬ä¸€ä¸ªå‡½æ•°ã€‚</p>
<p><strong>useEffect å¯ä»¥ç”¨ä½œæ•°æ®äº¤äº’ã€‚</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs jsx"><span class="hljs-comment">/* æ¨¡æ‹Ÿæ•°æ®äº¤äº’ */</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getUserInfo</span>(<span class="hljs-params">a</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;<br>        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>            <span class="hljs-title function_">resolve</span>(&#123;<br>                <span class="hljs-attr">name</span>: a,<br>                <span class="hljs-attr">age</span>: <span class="hljs-number">16</span>,<br>            &#125;);<br>        &#125;, <span class="hljs-number">500</span>);<br>    &#125;);<br>&#125;<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">DemoEffect</span> = (<span class="hljs-params">&#123; a &#125;</span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> [userMessage, setUserMessage]: any = <span class="hljs-title function_">useState</span>(&#123;&#125;);<br>    <span class="hljs-keyword">const</span> div = <span class="hljs-title function_">useRef</span>();<br>    <span class="hljs-keyword">const</span> [number, setNumber] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-comment">/* æ¨¡æ‹Ÿäº‹ä»¶ç›‘å¬å¤„ç†å‡½æ•° */</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleResize</span> = (<span class="hljs-params"></span>) =&gt; &#123;&#125;;<br>    <span class="hljs-comment">/* useEffectä½¿ç”¨ ï¼Œè¿™é‡Œå¦‚æœä¸åŠ é™åˆ¶ ï¼Œä¼šæ˜¯å‡½æ•°é‡å¤æ‰§è¡Œï¼Œé™·å…¥æ­»å¾ªç¯*/</span><br>    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-comment">/* è¯·æ±‚æ•°æ® */</span><br>        <span class="hljs-title function_">getUserInfo</span>(a).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;<br>            <span class="hljs-title function_">setUserMessage</span>(res);<br>        &#125;);<br>        <span class="hljs-comment">/* æ“ä½œdom  */</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-property">current</span>); <span class="hljs-comment">/* div */</span><br>        <span class="hljs-comment">/* äº‹ä»¶ç›‘å¬ç­‰ */</span><br>        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;resize&quot;</span>, handleResize);<br>        <span class="hljs-comment">/* åªæœ‰å½“props-&gt;aå’Œstate-&gt;numberæ”¹å˜çš„æ—¶å€™ ,useEffectå‰¯ä½œç”¨å‡½æ•°é‡æ–°æ‰§è¡Œ ï¼Œå¦‚æœæ­¤æ—¶æ•°ç»„ä¸ºç©º[]ï¼Œè¯æ˜å‡½æ•°åªæœ‰åœ¨åˆå§‹åŒ–çš„æ—¶å€™æ‰§è¡Œä¸€æ¬¡ç›¸å½“äºcomponentDidMount */</span><br>    &#125;, [a, number]);<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;div&#125;</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#123;userMessage.name&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#123;userMessage.age&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> setNumber(1)&#125;&gt;&#123;number&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;;<br></code></pre></td></tr></table></figure>

<p><strong>useEffect å¯ä»¥ç”¨ä½œäº‹ä»¶ç›‘å¬ï¼Œè¿˜æœ‰ä¸€äº›åŸºäº<code>dom</code>çš„æ“ä½œã€‚</strong>,åˆ«å¿˜äº†åœ¨<code>useEffect</code>ç¬¬ä¸€ä¸ªå‚æ•°å›è°ƒå‡½æ•°ï¼Œè¿”ä¸€ä¸ªå‡½æ•°ç”¨äºæ¸…é™¤äº‹ä»¶ç›‘å¬ç­‰æ“ä½œã€‚</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> <span class="hljs-title function_">DemoEffect</span> = (<span class="hljs-params">&#123; a &#125;</span>) =&gt; &#123;<br>    <span class="hljs-comment">/* æ¨¡æ‹Ÿäº‹ä»¶ç›‘å¬å¤„ç†å‡½æ•° */</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleResize</span> = (<span class="hljs-params"></span>) =&gt; &#123;&#125;;<br>    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-comment">/* å®šæ—¶å™¨ å»¶æ—¶å™¨ç­‰ */</span><br>        <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">666</span>), <span class="hljs-number">1000</span>);<br>        <span class="hljs-comment">/* äº‹ä»¶ç›‘å¬ */</span><br>        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;resize&quot;</span>, handleResize);<br>        <span class="hljs-comment">/* æ­¤å‡½æ•°ç”¨äºæ¸…é™¤å‰¯ä½œç”¨ */</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-built_in">clearInterval</span>(timer);<br>            <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&quot;resize&quot;</span>, handleResize);<br>        &#125;;<br>    &#125;, [a]);<br>    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;<br>&#125;;<br></code></pre></td></tr></table></figure>

<h2 id="useMemo"><a href="#useMemo" class="headerlink" title="useMemo"></a>useMemo</h2><p><code>useMemo</code>æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›å€¼ç”¨äºäº§ç”Ÿ<strong>ä¿å­˜å€¼</strong>ã€‚ ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä½œä¸º<code>dep</code>ä¾èµ–é¡¹ï¼Œæ•°ç»„é‡Œé¢çš„ä¾èµ–é¡¹å‘ç”Ÿå˜åŒ–ï¼Œé‡æ–°æ‰§è¡Œç¬¬ä¸€ä¸ªå‡½æ•°ï¼Œäº§ç”Ÿ<strong>æ–°çš„å€¼</strong>ã€‚</p>
<p>åº”ç”¨åœºæ™¯ï¼š <strong>1 ç¼“å­˜ä¸€äº›å€¼ï¼Œé¿å…é‡æ–°æ‰§è¡Œä¸Šä¸‹æ–‡</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> number = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-comment">/** ....å¤§é‡çš„é€»è¾‘è¿ç®— **/</span><br>    <span class="hljs-keyword">return</span> number;<br>&#125;, [props.<span class="hljs-property">number</span>]); <span class="hljs-comment">// åªæœ‰ props.number æ”¹å˜çš„æ—¶å€™ï¼Œé‡æ–°è®¡ç®—numberçš„å€¼ã€‚</span><br></code></pre></td></tr></table></figure>

<p><strong>2 å‡å°‘ä¸å¿…è¦çš„<code>dom</code>å¾ªç¯</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/* ç”¨ useMemoåŒ…è£¹çš„listå¯ä»¥é™å®šå½“ä¸”ä»…å½“listæ”¹å˜çš„æ—¶å€™æ‰æ›´æ–°æ­¤listï¼Œè¿™æ ·å°±å¯ä»¥é¿å…selectListé‡æ–°å¾ªç¯ */</span><br>&#123;<br>    <span class="hljs-title function_">useMemo</span>(<br>        <span class="hljs-function">() =&gt;</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                &#123;selectList.map((i, v) =&gt; (</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&#123;style.listSpan&#125;</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;v&#125;</span>&gt;</span></span><br><span class="language-xml">                        &#123;i.patentName&#125;</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">                ))&#125;</span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        ),<br>        [selectList]<br>    );<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>3 å‡å°‘å­ç»„ä»¶æ¸²æŸ“</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/* åªæœ‰å½“propsä¸­ï¼Œliståˆ—è¡¨æ”¹å˜çš„æ—¶å€™ï¼Œå­ç»„ä»¶æ‰æ¸²æŸ“ */</span><br><span class="hljs-keyword">const</span> goodListChild = <span class="hljs-title function_">useMemo</span>(<br>    <span class="hljs-function">() =&gt;</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">GoodList</span> <span class="hljs-attr">list</span>=<span class="hljs-string">&#123;props.list&#125;</span> /&gt;</span></span>,<br>    [props.<span class="hljs-property">list</span>]<br>);<br></code></pre></td></tr></table></figure>

<h2 id="useCallback"><a href="#useCallback" class="headerlink" title="useCallback"></a>useCallback</h2><p><code>useMemo</code> å’Œ <code>useCallback</code> æ¥æ”¶çš„å‚æ•°éƒ½æ˜¯ä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨å…¶ä¾èµ–é¡¹å‘ç”Ÿå˜åŒ–åæ‰æ‰§è¡Œï¼Œéƒ½æ˜¯è¿”å›ç¼“å­˜çš„å€¼ï¼ŒåŒºåˆ«åœ¨äº <code>useMemo</code> è¿”å›çš„æ˜¯å‡½æ•°è¿è¡Œçš„ç»“æœï¼Œ <code>useCallback</code> è¿”å›çš„æ˜¯å‡½æ•°ã€‚ è¿”å›çš„<code>callback</code>å¯ä»¥ä½œä¸º<code>props</code>å›è°ƒå‡½æ•°ä¼ é€’ç»™å­ç»„ä»¶ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/* ç”¨react.memo */</span><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">DemoChildren</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">memo</span>(<span class="hljs-function">(<span class="hljs-params">props</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">/* åªæœ‰åˆå§‹åŒ–çš„æ—¶å€™æ‰“å°äº† å­ç»„ä»¶æ›´æ–° */</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;å­ç»„ä»¶æ›´æ–°&quot;</span>);<br>    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        props.<span class="hljs-title function_">getInfo</span>(<span class="hljs-string">&quot;å­ç»„ä»¶&quot;</span>);<br>    &#125;, []);<br>    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>å­ç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;<br>&#125;);<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">DemoUseCallback</span> = (<span class="hljs-params">&#123; id &#125;</span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> [number, setNumber] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">1</span>);<br>    <span class="hljs-comment">/* æ­¤æ—¶usecallbackçš„ç¬¬ä¸€å‚æ•° (sonName)=&gt;&#123; console.log(sonName) &#125;</span><br><span class="hljs-comment">     ç»è¿‡å¤„ç†èµ‹å€¼ç»™ getInfo */</span><br>    <span class="hljs-keyword">const</span> getInfo = <span class="hljs-title function_">useCallback</span>(<br>        <span class="hljs-function">(<span class="hljs-params">sonName</span>) =&gt;</span> &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(sonName);<br>        &#125;,<br>        [id]<br>    );<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            &#123;/* ç‚¹å‡»æŒ‰é’®è§¦å‘çˆ¶ç»„ä»¶æ›´æ–° ï¼Œä½†æ˜¯å­ç»„ä»¶æ²¡æœ‰æ›´æ–° */&#125;</span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> setNumber(number + 1)&#125;&gt;å¢åŠ <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">DemoChildren</span> <span class="hljs-attr">getInfo</span>=<span class="hljs-string">&#123;getInfo&#125;</span> /&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;;<br></code></pre></td></tr></table></figure>

<h2 id="useRef"><a href="#useRef" class="headerlink" title="useRef"></a>useRef</h2><p><code>useRef</code>çš„ä½œç”¨ï¼š</p>
<ul>
<li>ä¸€ æ˜¯å¯ä»¥ç”¨æ¥è·å–<code>dom</code>å…ƒç´ ï¼Œæˆ–è€…<code>class</code>ç»„ä»¶å®ä¾‹ ã€‚</li>
<li>äºŒ <code>react-hooksåŸç†</code>æ–‡ç« ä¸­è®²è¿‡ï¼Œåˆ›å»º<code>useRef</code>æ—¶å€™ï¼Œä¼šåˆ›å»ºä¸€ä¸ªåŸå§‹å¯¹è±¡ï¼Œåªè¦å‡½æ•°ç»„ä»¶ä¸è¢«é”€æ¯ï¼ŒåŸå§‹å¯¹è±¡å°±ä¼šä¸€ç›´å­˜åœ¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œæ¥é€šè¿‡<code>useRef</code>ä¿å­˜ä¸€äº›æ•°æ®ã€‚</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> <span class="hljs-title function_">DemoUseRef</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> dom = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);<br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handerSubmit</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>        <span class="hljs-comment">/*  &lt;div &gt;è¡¨å•ç»„ä»¶&lt;/div&gt;  dom èŠ‚ç‚¹ */</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dom.<span class="hljs-property">current</span>);<br>    &#125;;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            &#123;/* ref æ ‡è®°å½“å‰domèŠ‚ç‚¹ */&#125;</span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;dom&#125;</span>&gt;</span>è¡¨å•ç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> handerSubmit()&#125;&gt;æäº¤<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;;<br></code></pre></td></tr></table></figure>

<h2 id="useLayoutEffect"><a href="#useLayoutEffect" class="headerlink" title="useLayoutEffect"></a>useLayoutEffect</h2><p><strong><code>useEffect</code>æ‰§è¡Œé¡ºåº:</strong> ç»„ä»¶æ›´æ–°æŒ‚è½½å®Œæˆ -&gt; æµè§ˆå™¨ <code>dom</code> ç»˜åˆ¶å®Œæˆ -&gt; æ‰§è¡Œ <code>useEffect</code> å›è°ƒã€‚ <strong><code>useLayoutEffect</code> æ‰§è¡Œé¡ºåº:</strong> ç»„ä»¶æ›´æ–°æŒ‚è½½å®Œæˆ -&gt; æ‰§è¡Œ <code>useLayoutEffect</code> å›è°ƒ-&gt; æµè§ˆå™¨<code>dom</code>ç»˜åˆ¶å®Œæˆã€‚</p>
<p>æ‰€ä»¥è¯´ <code>useLayoutEffect</code> ä»£ç å¯èƒ½ä¼šé˜»å¡æµè§ˆå™¨çš„ç»˜åˆ¶ ã€‚æˆ‘ä»¬å†™çš„ <code>effect</code>å’Œ <code>useLayoutEffect</code>ï¼Œ<code>react</code>åœ¨åº•å±‚ä¼šè¢«åˆ†åˆ«æ‰“ä¸Š<code>PassiveEffect</code>ï¼Œ<code>HookLayout</code>ï¼Œåœ¨<code>commit</code>é˜¶æ®µåŒºåˆ†å‡ºï¼Œåœ¨ä»€ä¹ˆæ—¶æœºæ‰§è¡Œã€‚</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> <span class="hljs-title function_">DemoUseLayoutEffect</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> target = <span class="hljs-title function_">useRef</span>();<br>    <span class="hljs-title function_">useLayoutEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-comment">/*æˆ‘ä»¬éœ€è¦åœ¨domç»˜åˆ¶ä¹‹å‰ï¼Œç§»åŠ¨domåˆ°åˆ¶å®šä½ç½®*/</span><br>        <span class="hljs-keyword">const</span> &#123; x, y &#125; = <span class="hljs-title function_">getPositon</span>(); <span class="hljs-comment">/* è·å–è¦ç§»åŠ¨çš„ x,yåæ ‡ */</span><br>        <span class="hljs-title function_">animate</span>(target.<span class="hljs-property">current</span>, &#123; x, y &#125;);<br>    &#125;, []);<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;target&#125;</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;animate&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;;<br></code></pre></td></tr></table></figure>

<h2 id="useReducer"><a href="#useReducer" class="headerlink" title="useReducer"></a>useReducer</h2><p>åœ¨<code>react-hooks</code>åŸç†é‚£ç¯‡æ–‡ç« ä¸­è®²è§£åˆ°ï¼Œ<code>useState</code>åº•å±‚å°±æ˜¯ä¸€ä¸ªç®€å•ç‰ˆçš„<code>useReducer</code></p>
<p><code>useReducer</code> æ¥å—çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºå®ƒå°±æ˜¯ä¸€ä¸ª <code>reducer</code> , <code>reducer</code> çš„å‚æ•°å°±æ˜¯å¸¸è§„ <code>reducer</code> é‡Œé¢çš„ <code>state</code> å’Œ <code>action</code> ,è¿”å›æ”¹å˜åçš„ <code>state</code> , <code>useReducer</code> ç¬¬äºŒä¸ªå‚æ•°ä¸º <code>state</code> çš„åˆå§‹å€¼ è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„ç¬¬ä¸€é¡¹å°±æ˜¯æ›´æ–°ä¹‹å <code>state</code> çš„å€¼ ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ´¾å‘æ›´æ–°çš„ <code>dispatch</code> å‡½æ•°ã€‚</p>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>useReducer</code>å¦‚ä½•ä½¿ç”¨ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">DemoUseReducer</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-comment">/* numberä¸ºæ›´æ–°åçš„stateå€¼,  dispatchNumbner ä¸ºå½“å‰çš„æ´¾å‘å‡½æ•° */</span><br>    <span class="hljs-keyword">const</span> [number, dispatchNumbner] = <span class="hljs-title function_">useReducer</span>(<span class="hljs-function">(<span class="hljs-params">state, action</span>) =&gt;</span> &#123;<br>        <span class="hljs-keyword">const</span> &#123; payload, name &#125; = action;<br>        <span class="hljs-comment">/* returnçš„å€¼ä¸ºæ–°çš„state */</span><br>        <span class="hljs-keyword">switch</span> (name) &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;add&quot;</span>:<br>                <span class="hljs-keyword">return</span> state + <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;sub&quot;</span>:<br>                <span class="hljs-keyword">return</span> state - <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;reset&quot;</span>:<br>                <span class="hljs-keyword">return</span> payload;<br>        &#125;<br>        <span class="hljs-keyword">return</span> state;<br>    &#125;, <span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            å½“å‰å€¼ï¼š&#123;number&#125;</span><br><span class="language-xml">            &#123;/* æ´¾å‘æ›´æ–° */&#125;</span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> dispatchNumbner(&#123; name: &quot;add&quot; &#125;)&#125;&gt;</span><br><span class="language-xml">                å¢åŠ </span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> dispatchNumbner(&#123; name: &quot;sub&quot; &#125;)&#125;&gt;</span><br><span class="language-xml">                å‡å°‘</span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> dispatchNumbner(&#123; name: &quot;reset&quot;, payload: 666 &#125;)&#125;</span><br><span class="language-xml">            &gt;</span><br><span class="language-xml">                èµ‹å€¼</span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            &#123;/* æŠŠdispatch å’Œ state ä¼ é€’ç»™å­ç»„ä»¶  */&#125;</span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">MyChildren</span> <span class="hljs-attr">dispatch</span>=<span class="hljs-string">&#123;dispatchNumbner&#125;</span> <span class="hljs-attr">State</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">number</span> &#125;&#125; /&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;;<br></code></pre></td></tr></table></figure>

<h2 id="useContext"><a href="#useContext" class="headerlink" title="useContext"></a>useContext</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>useContext</code> ï¼Œæ¥è·å–çˆ¶çº§ç»„ä»¶ä¼ é€’è¿‡æ¥çš„ <code>context</code> å€¼ï¼Œè¿™ä¸ªå½“å‰å€¼å°±æ˜¯æœ€è¿‘çš„çˆ¶çº§ç»„ä»¶ <code>Provider</code> è®¾ç½®çš„ <code>value</code> <code>å€¼ï¼ŒuseContext</code> å‚æ•°ä¸€èˆ¬æ˜¯ç”± <code>createContext</code> æ–¹å¼å¼•å…¥ ,ä¹Ÿå¯ä»¥çˆ¶çº§ä¸Šä¸‹æ–‡ <code>context</code> ä¼ é€’ ( å‚æ•°ä¸º <code>context</code> )ã€‚<code>useContext</code> å¯ä»¥ä»£æ›¿ <code>context.Consumer</code> æ¥è·å– <code>Provider</code> ä¸­ä¿å­˜çš„ <code>value</code> å€¼</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs jsx"><span class="hljs-comment">/* ç”¨useContextæ–¹å¼ */</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">DemoContext</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> <span class="hljs-attr">value</span>: any = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">Context</span>);<br>    <span class="hljs-comment">/* my name is alien */</span><br>    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span> my name is &#123;value.name&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;<br>&#125;;<br><span class="hljs-comment">/* ç”¨Context.Consumer æ–¹å¼ */</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">DemoContext1</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Context.Consumer</span>&gt;</span></span><br><span class="language-xml">            &#123;/*  my name is alien  */&#125;</span><br><span class="language-xml">            &#123;(value) =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span> my name is &#123;value.name&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>&#125;</span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">Context.Consumer</span>&gt;</span></span><br>    );<br>&#125;;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> () =&gt; &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">Context.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">name:</span> &quot;<span class="hljs-attr">alien</span>&quot;, <span class="hljs-attr">age:</span> <span class="hljs-attr">18</span> &#125;&#125;&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">DemoContext</span> /&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">DemoContext1</span> /&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">Context.Provider</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;;<br></code></pre></td></tr></table></figure>

<h2 id="useImperativeHandle"><a href="#useImperativeHandle" class="headerlink" title="useImperativeHandle"></a>useImperativeHandle</h2><p><code>useImperativeHandle</code> å¯ä»¥é…åˆ <code>forwardRef</code> è‡ªå®šä¹‰æš´éœ²ç»™çˆ¶ç»„ä»¶çš„å®ä¾‹å€¼ã€‚è¿™ä¸ªå¾ˆæœ‰ç”¨ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºå­ç»„ä»¶ï¼Œå¦‚æœæ˜¯<code>class</code>ç±»ç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>ref</code>è·å–ç±»ç»„ä»¶çš„å®ä¾‹ï¼Œä½†æ˜¯åœ¨å­ç»„ä»¶æ˜¯å‡½æ•°ç»„ä»¶çš„æƒ…å†µï¼Œå¦‚æœæˆ‘ä»¬ä¸èƒ½ç›´æ¥é€šè¿‡<code>ref</code>çš„ï¼Œé‚£ä¹ˆæ­¤æ—¶<code>useImperativeHandle</code>å’Œ <code>forwardRef</code>é…åˆå°±èƒ½è¾¾åˆ°æ•ˆæœã€‚</p>
<p><code>useImperativeHandle</code>æ¥å—ä¸‰ä¸ªå‚æ•°ï¼š</p>
<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•° ref: æ¥å— <code>forWardRef</code> ä¼ é€’è¿‡æ¥çš„ <code>ref</code>ã€‚</li>
<li>ç¬¬äºŒä¸ªå‚æ•° <code>createHandle</code> ï¼šå¤„ç†å‡½æ•°ï¼Œè¿”å›å€¼ä½œä¸ºæš´éœ²ç»™çˆ¶ç»„ä»¶çš„<code>ref</code>å¯¹è±¡ã€‚</li>
<li>ç¬¬ä¸‰ä¸ªå‚æ•° <code>deps</code>:ä¾èµ–é¡¹ <code>deps</code>ï¼Œä¾èµ–é¡¹æ›´æ”¹å½¢æˆæ–°çš„<code>ref</code>å¯¹è±¡ã€‚</li>
</ul>
<p><strong>æˆ‘ä»¬æ¥æ¨¡æ‹Ÿç»™åœºæ™¯ï¼Œç”¨<code>useImperativeHandle</code>ï¼Œä½¿å¾—çˆ¶ç»„ä»¶èƒ½è®©å­ç»„ä»¶ä¸­çš„<code>input</code>è‡ªåŠ¨èµ‹å€¼å¹¶èšç„¦ã€‚</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Son</span>(<span class="hljs-params">props, ref</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(props);<br>    <span class="hljs-keyword">const</span> inputRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);<br>    <span class="hljs-keyword">const</span> [inputValue, setInputValue] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">&quot;&quot;</span>);<br>    <span class="hljs-title function_">useImperativeHandle</span>(<br>        ref,<br>        <span class="hljs-function">() =&gt;</span> &#123;<br>            <span class="hljs-keyword">const</span> handleRefs = &#123;<br>                <span class="hljs-comment">/* å£°æ˜æ–¹æ³•ç”¨äºèšç„¦inputæ¡† */</span><br>                <span class="hljs-title function_">onFocus</span>(<span class="hljs-params"></span>) &#123;<br>                    inputRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">focus</span>();<br>                &#125;,<br>                <span class="hljs-comment">/* å£°æ˜æ–¹æ³•ç”¨äºæ”¹å˜inputçš„å€¼ */</span><br>                <span class="hljs-title function_">onChangeValue</span>(<span class="hljs-params">value</span>) &#123;<br>                    <span class="hljs-title function_">setInputValue</span>(value);<br>                &#125;,<br>            &#125;;<br>            <span class="hljs-keyword">return</span> handleRefs;<br>        &#125;,<br>        []<br>    );<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;è¯·è¾“å…¥å†…å®¹&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;inputRef&#125;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;inputValue&#125;</span> /&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ForwarSon</span> = <span class="hljs-title function_">forwardRef</span>(<span class="hljs-title class_">Son</span>);<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    inputRef = <span class="hljs-literal">null</span>;<br>    <span class="hljs-title function_">handerClick</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">const</span> &#123; onFocus, onChangeValue &#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cur</span>;<br>        <span class="hljs-title function_">onFocus</span>();<br>        <span class="hljs-title function_">onChangeValue</span>(<span class="hljs-string">&quot;let us learn React!&quot;</span>);<br>    &#125;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">marginTop:</span> &quot;<span class="hljs-attr">50px</span>&quot; &#125;&#125;&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ForwarSon</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;(node)</span> =&gt;</span> (this.inputRef = node)&#125; /&gt;</span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.handerClick.bind(this)&#125;</span>&gt;</span></span><br><span class="language-xml">                    æ“æ§å­ç»„ä»¶</span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        );<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ•ˆæœ:</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8e8c05f0c82c43719079d4db9536abc0~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="useImperativeHandle.gif"></p>
<h2 id="useDebugValue"><a href="#useDebugValue" class="headerlink" title="useDebugValue"></a>useDebugValue</h2><p><code>useDebugValue</code> å¯ç”¨äºåœ¨ <code>React</code> å¼€å‘è€…å·¥å…·ä¸­æ˜¾ç¤ºè‡ªå®šä¹‰ <code>hook</code> çš„æ ‡ç­¾ã€‚è¿™ä¸ª<code>hooks</code>ç›®çš„å°±æ˜¯æ£€æŸ¥è‡ªå®šä¹‰<code>hooks</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">useFriendStatus</span>(<span class="hljs-params">friendID</span>) &#123;<br>    <span class="hljs-keyword">const</span> [isOnline, setIsOnline] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);<br>    <span class="hljs-comment">// ...</span><br>    <span class="hljs-comment">// åœ¨å¼€å‘è€…å·¥å…·ä¸­çš„è¿™ä¸ª Hook æ—è¾¹æ˜¾ç¤ºæ ‡ç­¾</span><br>    <span class="hljs-comment">// e.g. &quot;FriendStatus: Online&quot;</span><br>    <span class="hljs-title function_">useDebugValue</span>(isOnline ? <span class="hljs-string">&quot;Online&quot;</span> : <span class="hljs-string">&quot;Offline&quot;</span>);<br><br>    <span class="hljs-keyword">return</span> isOnline;<br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>æˆ‘ä»¬ä¸æ¨èä½ å‘æ¯ä¸ªè‡ªå®šä¹‰ Hook æ·»åŠ  debug å€¼ã€‚å½“å®ƒä½œä¸ºå…±äº«åº“çš„ä¸€éƒ¨åˆ†æ—¶æ‰æœ€æœ‰ä»·å€¼ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ ¼å¼åŒ–å€¼çš„æ˜¾ç¤ºå¯èƒ½æ˜¯ä¸€é¡¹å¼€é”€å¾ˆå¤§çš„æ“ä½œã€‚é™¤ééœ€è¦æ£€æŸ¥ Hookï¼Œå¦åˆ™æ²¡æœ‰å¿…è¦è¿™ä¹ˆåšã€‚å› æ­¤ï¼ŒuseDebugValue æ¥å—ä¸€ä¸ªæ ¼å¼åŒ–å‡½æ•°ä½œä¸ºå¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚è¯¥å‡½æ•°åªæœ‰åœ¨ Hook è¢«æ£€æŸ¥æ—¶æ‰ä¼šè¢«è°ƒç”¨ã€‚å®ƒæ¥å— debug å€¼ä½œä¸ºå‚æ•°ï¼Œå¹¶ä¸”ä¼šè¿”å›ä¸€ä¸ªæ ¼å¼åŒ–çš„æ˜¾ç¤ºå€¼ã€‚</p>
</blockquote>
<h2 id="useTransition"><a href="#useTransition" class="headerlink" title="useTransition"></a>useTransition</h2><p><code>useTransition</code>å…è®¸å»¶æ—¶ç”±<code>state</code>æ”¹å˜è€Œå¸¦æ¥çš„è§†å›¾æ¸²æŸ“ã€‚é¿å…ä¸å¿…è¦çš„æ¸²æŸ“ã€‚å®ƒè¿˜å…è®¸ç»„ä»¶å°†é€Ÿåº¦è¾ƒæ…¢çš„æ•°æ®è·å–æ›´æ–°æ¨è¿Ÿåˆ°éšåæ¸²æŸ“ï¼Œä»¥ä¾¿èƒ½å¤Ÿç«‹å³æ¸²æŸ“æ›´é‡è¦çš„æ›´æ–°ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TIMEOUT_MS</span> = &#123; <span class="hljs-attr">timeoutMs</span>: <span class="hljs-number">2000</span> &#125;;<br><span class="hljs-keyword">const</span> [startTransition, isPending] = <span class="hljs-title function_">useTransition</span>(<span class="hljs-variable constant_">TIMEOUT_MS</span>);<br></code></pre></td></tr></table></figure>

<ul>
<li><code>useTransition</code> æ¥å—ä¸€ä¸ªå¯¹è±¡ï¼Œ <code>timeoutMs</code>ä»£ç éœ€è¦å»¶æ—¶çš„æ—¶é—´ã€‚</li>
<li>è¿”å›ä¸€ä¸ªæ•°ç»„ã€‚<strong>ç¬¬ä¸€ä¸ªå‚æ•°ï¼š</strong> æ˜¯ä¸€ä¸ªæ¥å—å›è°ƒçš„å‡½æ•°ã€‚æˆ‘ä»¬ç”¨å®ƒæ¥å‘Šè¯‰ <code>React</code> éœ€è¦æ¨è¿Ÿçš„ <code>state</code> ã€‚ <strong>ç¬¬äºŒä¸ªå‚æ•°ï¼š</strong> ä¸€ä¸ªå¸ƒå°”å€¼ã€‚è¡¨ç¤ºæ˜¯å¦æ­£åœ¨ç­‰å¾…ï¼Œè¿‡åº¦çŠ¶æ€çš„å®Œæˆ(å»¶æ—¶<code>state</code>çš„æ›´æ–°)ã€‚</li>
</ul>
<p>ä¸‹é¢æˆ‘ä»¬å¼•å…¥å®˜ç½‘çš„åˆ—å­ï¼Œæ¥äº†è§£<code>useTransition</code>çš„ä½¿ç”¨ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SUSPENSE_CONFIG</span> = &#123; <span class="hljs-attr">timeoutMs</span>: <span class="hljs-number">2000</span> &#125;;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">const</span> [resource, setResource] = <span class="hljs-title function_">useState</span>(initialResource);<br>    <span class="hljs-keyword">const</span> [startTransition, isPending] = <span class="hljs-title function_">useTransition</span>(<span class="hljs-variable constant_">SUSPENSE_CONFIG</span>);<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">disabled</span>=<span class="hljs-string">&#123;isPending&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> &#123;</span><br><span class="language-xml">                    startTransition(() =&gt; &#123;</span><br><span class="language-xml">                        const nextUserId = getNextId(resource.userId);</span><br><span class="language-xml">                        setResource(fetchProfileData(nextUserId));</span><br><span class="language-xml">                    &#125;);</span><br><span class="language-xml">                &#125;&#125;</span><br><span class="language-xml">            &gt;</span><br><span class="language-xml">                Next</span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            &#123;isPending ? &quot; åŠ è½½ä¸­...&quot; : null&#125;</span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">&#123;</span>&lt;<span class="hljs-attr">Spinner</span> /&gt;</span>&#125;&gt;</span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ProfilePage</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&#123;resource&#125;</span> /&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/&gt;</span></span><br>    );<br>&#125;<br></code></pre></td></tr></table></figure>

<p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>startTransition</code> åŒ…è£…äº†æˆ‘ä»¬çš„æ•°æ®è·å–ã€‚è¿™ä½¿æˆ‘ä»¬å¯ä»¥ç«‹å³å¼€å§‹è·å–ç”¨æˆ·èµ„æ–™çš„æ•°æ®ï¼ŒåŒæ—¶æ¨è¿Ÿä¸‹ä¸€ä¸ªç”¨æˆ·èµ„æ–™é¡µé¢ä»¥åŠå…¶å…³è”çš„ <code>Spinner</code> çš„æ¸²æŸ“ 2 ç§’é’Ÿï¼ˆ <code>timeoutMs</code> ä¸­æ˜¾ç¤ºçš„æ—¶é—´ï¼‰ã€‚</p>
<p>è¿™ä¸ª<code>api</code>ç›®å‰å¤„äºå®éªŒé˜¶æ®µï¼Œæ²¡æœ‰è¢«å®Œå…¨å¼€æ”¾å‡ºæ¥ã€‚</p>
<h1 id="react-dom"><a href="#react-dom" class="headerlink" title="react-dom"></a>react-dom</h1><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥ä¸€èµ·ç ”ç©¶<code>react-dom</code>ä¸­æ¯”è¾ƒé‡è¦çš„<code>api</code>ã€‚</p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/23d877cf3a5b417ba6162f0c259b1c45~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="react-dom.jpg"></p>
<h2 id="render"><a href="#render" class="headerlink" title="render"></a>render</h2><p><code>render</code> æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„<code>react-dom</code>çš„ <code>api</code>ï¼Œç”¨äºæ¸²æŸ“ä¸€ä¸ª<code>react</code>å…ƒç´ ï¼Œä¸€èˆ¬<code>react</code>é¡¹ç›®æˆ‘ä»¬éƒ½ç”¨å®ƒï¼Œæ¸²æŸ“æ ¹éƒ¨å®¹å™¨<code>app</code>ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(element, container[, callback])<br></code></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jsx"><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>, <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;app&quot;</span>));<br></code></pre></td></tr></table></figure>

<p><code>ReactDOM.render</code>ä¼šæ§åˆ¶<code>container</code>å®¹å™¨èŠ‚ç‚¹é‡Œçš„å†…å®¹ï¼Œä½†æ˜¯ä¸ä¼šä¿®æ”¹å®¹å™¨èŠ‚ç‚¹æœ¬èº«ã€‚</p>
<h2 id="hydrate"><a href="#hydrate" class="headerlink" title="hydrate"></a>hydrate</h2><p>æœåŠ¡ç«¯æ¸²æŸ“ç”¨<code>hydrate</code>ã€‚ç”¨æ³•ä¸ <code>render()</code> ç›¸åŒï¼Œä½†å®ƒç”¨äºåœ¨ <code>ReactDOMServer</code> æ¸²æŸ“çš„å®¹å™¨ä¸­å¯¹ <code>HTML</code> çš„å†…å®¹è¿›è¡Œ <code>hydrate</code> æ“ä½œã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">hydrate</span>(element, container[, callback])<br></code></pre></td></tr></table></figure>

<h2 id="createPortal"><a href="#createPortal" class="headerlink" title="createPortal"></a>createPortal</h2><p><code>Portal</code> æä¾›äº†ä¸€ç§å°†å­èŠ‚ç‚¹æ¸²æŸ“åˆ°å­˜åœ¨äºçˆ¶ç»„ä»¶ä»¥å¤–çš„ <code>DOM</code> èŠ‚ç‚¹çš„ä¼˜ç§€çš„æ–¹æ¡ˆã€‚<code>createPortal</code> å¯ä»¥æŠŠå½“å‰ç»„ä»¶æˆ– <code>element</code> å…ƒç´ çš„å­èŠ‚ç‚¹ï¼Œæ¸²æŸ“åˆ°ç»„ä»¶ä¹‹å¤–çš„å…¶ä»–åœ°æ–¹ã€‚</p>
<p>é‚£ä¹ˆå…·ä½“åº”ç”¨åˆ°ä»€ä¹ˆåœºæ™¯å‘¢ï¼Ÿ</p>
<p>æ¯”å¦‚ä¸€äº›å…¨å±€çš„å¼¹çª—ç»„ä»¶<code>model</code>,<code>&lt;Model/&gt;</code>ç»„ä»¶ä¸€èˆ¬éƒ½å†™åœ¨æˆ‘ä»¬çš„ç»„ä»¶å†…éƒ¨ï¼Œå€’æ˜¯çœŸæ­£æŒ‚è½½çš„<code>dom</code>ï¼Œéƒ½æ˜¯åœ¨å¤–å±‚å®¹å™¨ï¼Œæ¯”å¦‚<code>body</code>ä¸Šã€‚æ­¤æ—¶å°±å¾ˆé€‚åˆ<code>createPortal</code>APIã€‚</p>
<p><code>createPortal</code>æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">createPortal</span>(child, container);<br></code></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ªï¼š <code>child</code> æ˜¯ä»»ä½•å¯æ¸²æŸ“çš„ <code>React</code> å­å…ƒç´  ç¬¬äºŒä¸ªï¼š <code>container</code>æ˜¯ä¸€ä¸ª <code>DOM</code> å…ƒç´ ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å®è·µä¸€ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">WrapComponent</span>(<span class="hljs-params">&#123; children &#125;</span>) &#123;<br>    <span class="hljs-keyword">const</span> domRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);<br>    <span class="hljs-keyword">const</span> [<span class="hljs-title class_">PortalComponent</span>, setPortalComponent] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);<br>    <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-title function_">setPortalComponent</span>(<span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">createPortal</span>(children, domRef.<span class="hljs-property">current</span>));<br>    &#125;, []);<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;container&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;domRef&#125;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            &#123;PortalComponent&#125;</span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    );<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">marginTop:</span> &quot;<span class="hljs-attr">50px</span>&quot; &#125;&#125;&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">WrapComponent</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>hello,world<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">WrapComponent</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        );<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ•ˆæœ</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1842abaa8cb840108f6a5c90cb349aac~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="createPortal.jpg"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬<code>children</code>å®é™…åœ¨<code>container</code> ä¹‹å¤–æŒ‚è½½çš„ï¼Œä½†æ˜¯å·²ç»è¢«<code>createPortal</code>æ¸²æŸ“åˆ°<code>container</code>ä¸­ã€‚</p>
<h2 id="unstable-batchedUpdates"><a href="#unstable-batchedUpdates" class="headerlink" title="unstable_batchedUpdates"></a>unstable_batchedUpdates</h2><p>åœ¨<code>react-legacy</code>æ¨¡å¼ä¸‹ï¼Œå¯¹äºäº‹ä»¶ï¼Œ<code>react</code>äº‹ä»¶æœ‰æ‰¹é‡æ›´æ–°æ¥å¤„ç†åŠŸèƒ½,ä½†æ˜¯è¿™ä¸€äº›éå¸¸è§„çš„äº‹ä»¶ä¸­ï¼Œæ‰¹é‡æ›´æ–°åŠŸèƒ½ä¼šè¢«æ‰“ç ´ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨<code>react-dom</code>ä¸­æä¾›çš„<code>unstable_batchedUpdates</code> æ¥è¿›è¡Œæ‰¹é‡æ›´æ–°ã€‚</p>
<p><strong>ä¸€æ¬¡ç‚¹å‡»å®ç°çš„æ‰¹é‡æ›´æ–°</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) &#123;<br>        <span class="hljs-variable language_">super</span>(props);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = &#123;<br>            <span class="hljs-attr">numer</span>: <span class="hljs-number">1</span>,<br>        &#125;;<br>    &#125;<br>    handerClick = <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">numer</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">numer</span> + <span class="hljs-number">1</span> &#125;);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">numer</span>);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">numer</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">numer</span> + <span class="hljs-number">1</span> &#125;);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">numer</span>);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">numer</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">numer</span> + <span class="hljs-number">1</span> &#125;);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">numer</span>);<br>    &#125;;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">marginTop:</span> &quot;<span class="hljs-attr">50px</span>&quot; &#125;&#125;&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.handerClick&#125;</span>&gt;</span>click me<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        );<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ•ˆæœ</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/29b6f884f2c147ee9a20400ad7477e77~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="batch1.jpg"></p>
<p>æ¸²æŸ“æ¬¡æ•°ä¸€æ¬¡ã€‚</p>
<p><strong>æ‰¹é‡æ›´æ–°æ¡ä»¶è¢«æ‰“ç ´</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js">handerClick = <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">numer</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">numer</span> + <span class="hljs-number">1</span> &#125;);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">numer</span>);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">numer</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">numer</span> + <span class="hljs-number">1</span> &#125;);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">numer</span>);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">numer</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">numer</span> + <span class="hljs-number">1</span> &#125;);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">numer</span>);<br>    &#125;);<br>&#125;;<br></code></pre></td></tr></table></figure>

<p><strong>æ•ˆæœ</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4b799b2b8f514ae183382d5ed875d0e9~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="batch2.jpg"></p>
<p>æ¸²æŸ“æ¬¡æ•°ä¸‰æ¬¡ã€‚</p>
<p><strong>unstable_batchedUpdate åŠ©åŠ›</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js">handerClick = <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">unstable_batchedUpdates</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">numer</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">numer</span> + <span class="hljs-number">1</span> &#125;);<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">numer</span>);<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">numer</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">numer</span> + <span class="hljs-number">1</span> &#125;);<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">numer</span>);<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">numer</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">numer</span> + <span class="hljs-number">1</span> &#125;);<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">numer</span>);<br>        &#125;);<br>    &#125;);<br>&#125;;<br></code></pre></td></tr></table></figure>

<p>æ¸²æŸ“æ¬¡æ•°ä¸€æ¬¡,å®Œç¾è§£å†³æ‰¹é‡æ›´æ–°é—®é¢˜ã€‚</p>
<h2 id="flushSync"><a href="#flushSync" class="headerlink" title="flushSync"></a>flushSync</h2><p><code>flushSync</code> å¯ä»¥å°†å›è°ƒå‡½æ•°ä¸­çš„æ›´æ–°ä»»åŠ¡ï¼Œæ”¾åœ¨ä¸€ä¸ªè¾ƒé«˜çš„ä¼˜å…ˆçº§ä¸­ã€‚æˆ‘ä»¬çŸ¥é“<code>react</code>è®¾å®šäº†å¾ˆå¤šä¸åŒä¼˜å…ˆçº§çš„æ›´æ–°ä»»åŠ¡ã€‚å¦‚æœä¸€æ¬¡æ›´æ–°ä»»åŠ¡åœ¨<code>flushSync</code>å›è°ƒå‡½æ•°å†…éƒ¨ï¼Œé‚£ä¹ˆå°†è·å¾—ä¸€ä¸ªè¾ƒé«˜ä¼˜å…ˆçº§çš„æ›´æ–°ã€‚æ¯”å¦‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">flushSync</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-comment">/* æ­¤æ¬¡æ›´æ–°å°†è®¾ç½®ä¸€ä¸ªè¾ƒé«˜ä¼˜å…ˆçº§çš„æ›´æ–° */</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;alien&quot;</span> &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure>

<p>ä¸ºäº†è®©å¤§å®¶ç†è§£<code>flushSync</code>ï¼Œæˆ‘è¿™é‡Œåšä¸€ä¸ª<code>demo</code>å¥‰ä¸Šï¼Œ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/* flushSync */</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">ReactDOM</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-dom&quot;</span>;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    state = &#123; <span class="hljs-attr">number</span>: <span class="hljs-number">0</span> &#125;;<br>    handerClick = <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">number</span>: <span class="hljs-number">1</span> &#125;);<br>        &#125;);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">number</span>: <span class="hljs-number">2</span> &#125;);<br>        <span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">flushSync</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">number</span>: <span class="hljs-number">3</span> &#125;);<br>        &#125;);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">number</span>: <span class="hljs-number">4</span> &#125;);<br>    &#125;;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">const</span> &#123; number &#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(number); <span class="hljs-comment">// æ‰“å°ä»€ä¹ˆï¼Ÿï¼Ÿ</span><br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>&#123;number&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.handerClick&#125;</span>&gt;</span>æµ‹è¯•flushSync<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        );<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å…ˆä¸çœ‹ç­”æ¡ˆï¼Œç‚¹å‡»ä¸€ä¸‹æŒ‰é’®ï¼Œæ‰“å°ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p><strong>æˆ‘ä»¬æ¥ç‚¹å‡»ä¸€ä¸‹çœ‹çœ‹</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f7eba600db1c44cb956e380cb922226d~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="flushSync.gif"></p>
<p>æ‰“å° 0 3 4 1 ï¼Œç›¸ä¿¡ä¸éš¾ç†è§£ä¸ºä»€ä¹ˆè¿™ä¹ˆæ‰“å°äº†ã€‚</p>
<ul>
<li>é¦–å…ˆ <code>flushSync</code> <code>this.setState(&#123; number: 3 &#125;)</code>è®¾å®šäº†ä¸€ä¸ªé«˜ä¼˜å…ˆçº§çš„æ›´æ–°ï¼Œæ‰€ä»¥ 3 å…ˆè¢«æ‰“å°</li>
<li>2 4 è¢«æ‰¹é‡æ›´æ–°ä¸º 4</li>
</ul>
<p>ç›¸ä¿¡è¿™ä¸ª<code>demo</code>è®©æˆ‘ä»¬æ›´æ·±å…¥äº†è§£äº†<code>flushSync</code>ã€‚</p>
<h2 id="findDOMNode"><a href="#findDOMNode" class="headerlink" title="findDOMNode"></a>findDOMNode</h2><p><code>findDOMNode</code>ç”¨äºè®¿é—®ç»„ä»¶<code>DOM</code>å…ƒç´ èŠ‚ç‚¹ï¼Œ<code>react</code>æ¨èä½¿ç”¨<code>ref</code>æ¨¡å¼ï¼Œä¸æœŸæœ›ä½¿ç”¨<code>findDOMNode</code>ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">findDOMNode</span>(component);<br></code></pre></td></tr></table></figure>

<p>æ³¨æ„çš„æ˜¯ï¼š</p>
<ul>
<li>1 <code>findDOMNode</code>åªèƒ½ç”¨åœ¨å·²ç»æŒ‚è½½çš„ç»„ä»¶ä¸Šã€‚</li>
<li>2 å¦‚æœç»„ä»¶æ¸²æŸ“å†…å®¹ä¸º <code>null</code> æˆ–è€…æ˜¯ <code>false</code>ï¼Œé‚£ä¹ˆ <code>findDOMNode</code>è¿”å›å€¼ä¹Ÿæ˜¯ <code>null</code>ã€‚</li>
<li>3 <code>findDOMNode</code> ä¸èƒ½ç”¨äºå‡½æ•°ç»„ä»¶ã€‚</li>
</ul>
<p>æ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼Œ<code>findDOMNode</code>å…·ä½“æ€ä¹ˆä½¿ç”¨çš„ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    handerFindDom = <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">findDOMNode</span>(<span class="hljs-variable language_">this</span>));<br>    &#125;;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">marginTop:</span> &quot;<span class="hljs-attr">100px</span>&quot; &#125;&#125;&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>hello,world<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.handerFindDom&#125;</span>&gt;</span>è·å–å®¹å™¨dom<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        );<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ•ˆæœï¼š</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f9acc582f69e461caf0887f49d710a35~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="findNodedom.gif"></p>
<p>æˆ‘ä»¬å®Œå…¨å¯ä»¥å°†å¤–å±‚å®¹å™¨ç”¨<code>ref</code>æ¥æ ‡è®°ï¼Œè·å–æ•è·åŸç”Ÿçš„<code>dom</code>èŠ‚ç‚¹ã€‚</p>
<h2 id="unmountComponentAtNode"><a href="#unmountComponentAtNode" class="headerlink" title="unmountComponentAtNode"></a>unmountComponentAtNode</h2><p>ä» <code>DOM</code> ä¸­å¸è½½ç»„ä»¶ï¼Œä¼šå°†å…¶äº‹ä»¶å¤„ç†å™¨å’Œ <code>state</code> ä¸€å¹¶æ¸…é™¤ã€‚ å¦‚æœæŒ‡å®šå®¹å™¨ä¸Šæ²¡æœ‰å¯¹åº”å·²æŒ‚è½½çš„ç»„ä»¶ï¼Œè¿™ä¸ªå‡½æ•°ä»€ä¹ˆä¹Ÿä¸ä¼šåšã€‚å¦‚æœç»„ä»¶è¢«ç§»é™¤å°†ä¼šè¿”å› <code>true</code> ï¼Œå¦‚æœæ²¡æœ‰ç»„ä»¶å¯è¢«ç§»é™¤å°†ä¼šè¿”å› <code>false</code> ã€‚</p>
<p>æˆ‘ä»¬æ¥ç®€å•ä¸¾ä¾‹çœ‹çœ‹<code>unmountComponentAtNode</code>å¦‚ä½•ä½¿ç”¨ï¼Ÿ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Text</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>hello,world<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    node = <span class="hljs-literal">null</span>;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) &#123;<br>        <span class="hljs-variable language_">super</span>(props);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = &#123;<br>            <span class="hljs-attr">numer</span>: <span class="hljs-number">1</span>,<br>        &#125;;<br>    &#125;<br>    <span class="hljs-title function_">componentDidMount</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">/*  ç»„ä»¶åˆå§‹åŒ–çš„æ—¶å€™ï¼Œåˆ›å»ºä¸€ä¸ª container å®¹å™¨ */</span><br>        <span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Text</span> /&gt;</span></span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">node</span>);<br>    &#125;<br>    handerClick = <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-comment">/* ç‚¹å‡»å¸è½½å®¹å™¨ */</span><br>        <span class="hljs-keyword">const</span> state = <span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">unmountComponentAtNode</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">node</span>);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(state);<br>    &#125;;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">marginTop:</span> &quot;<span class="hljs-attr">50px</span>&quot; &#125;&#125;&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;(node)</span> =&gt;</span> (this.node = node)&#125;&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.handerClick&#125;</span>&gt;</span>click me<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        );<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ•ˆæœ</strong></p>
<p><img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/15ebcd1a23e64561ae6346d4be7e958a~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="unmounted.gif"></p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬æ–‡é€šè¿‡<code>react</code>ç»„ä»¶å±‚é¢ï¼Œå·¥å…·å±‚é¢ï¼Œ<code>hooks</code>å±‚é¢ï¼Œ<code>react-dom</code>äº†è§£äº†<code>api</code>çš„ç”¨æ³•ï¼Œå¸Œæœ›çœ‹å®Œçš„åŒå­¦ï¼Œèƒ½å¤Ÿå¯¹ç€æ–‡ç« ä¸­çš„<code>demo</code>è‡ªå·±æ•²ä¸€éï¼Œåˆ°å¤´æ¥ä¼šå‘ç°è‡ªå·±æˆé•¿ä¸å°‘ã€‚</p>
<p>æœ€å, é€äººç«ç‘°ï¼Œæ‰‹ç•™ä½™é¦™ï¼Œè§‰å¾—æœ‰æ”¶è·çš„æœ‹å‹å¯ä»¥ç»™ç¬”è€…<strong>ç‚¹èµï¼Œå…³æ³¨</strong>ä¸€æ³¢ ï¼Œé™†ç»­æ›´æ–°å‰ç«¯è¶…ç¡¬æ ¸æ–‡ç« ã€‚</p>
<p>æå‰é€æ¼ï¼šæ¥ä¸‹æ¥ä¼šå‡ºä¸€éƒ¨æ­ç§˜<code>react</code>äº‹ä»¶ç³»ç»Ÿçš„æ–‡ç« ã€‚</p>
<p><strong>æ„Ÿå…´è¶£çš„åŒå­¦è¯·å…³æ³¨å…¬ä¼—å· <code>å‰ç«¯Sharing</code> æŒç»­æ¨é€ä¼˜è´¨å¥½æ–‡</strong></p>
<h2 id="å¾€æœŸ-react-æ–‡ç« "><a href="#å¾€æœŸ-react-æ–‡ç« " class="headerlink" title="å¾€æœŸ react æ–‡ç« "></a>å¾€æœŸ react æ–‡ç« </h2><p>æ–‡ç« ä¸­ï¼Œå¯¹äºå…¶ä»–æ²¡æœ‰è®²åˆ°çš„<code>react-hooks</code>ï¼Œå»ºè®®å¤§å®¶çœ‹<code>react-hooks</code>ä¸‰éƒ¨æ›²ã€‚</p>
<p><strong>react-hooks ä¸‰éƒ¨æ›²</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/6864438643727433741" title="https://juejin.cn/post/6864438643727433741">ç¬¬ä¸€éƒ¨ï¼š react-hooks å¦‚ä½•ä½¿ç”¨</a> <code>150+</code> èµ ğŸ‘</li>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/6890738145671938062" title="https://juejin.cn/post/6890738145671938062">ç¬¬äºŒéƒ¨ï¼šç©è½¬ react-hooks,è‡ªå®šä¹‰ hooks è®¾è®¡æ¨¡å¼åŠå…¶å®æˆ˜</a> <code>240+</code> ğŸ‘ èµ</li>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/6944863057000529933" title="https://juejin.cn/post/6944863057000529933">ç¬¬ä¸‰éƒ¨ï¼šã€Œreact è¿›é˜¶ã€ä¸€æ–‡åƒé€ react-hooks åŸç†</a> <code>820</code></li>
</ul>
<p><strong>react è¿›é˜¶ç³»åˆ—</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/6908895801116721160" title="https://juejin.cn/post/6908895801116721160">ã€Œreact è¿›é˜¶ã€å¹´ç»ˆé€ç»™ react å¼€å‘è€…çš„å…«æ¡ä¼˜åŒ–å»ºè®®</a> <code>918+</code> èµ ğŸ‘</li>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/6940422320427106335" title="https://juejin.cn/post/6940422320427106335">ã€Œreact è¿›é˜¶ã€ä¸€æ–‡åƒé€ React é«˜é˜¶ç»„ä»¶(HOC)</a> <code>330+</code> èµ ğŸ‘</li>
</ul>
<p><strong>react æºç ç³»åˆ—</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/6886290490640039943" title="https://juejin.cn/post/6886290490640039943">ã€Œæºç è§£æ ã€è¿™ä¸€æ¬¡å½»åº•å¼„æ‡‚ react-router è·¯ç”±åŸç†</a> <code>132+</code> èµ ğŸ‘</li>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/6937491452838559781" title="https://juejin.cn/post/6937491452838559781">ã€Œæºç è§£æã€ä¸€æ–‡åƒé€ react-redux æºç ï¼ˆuseMemo ç»å…¸æºç çº§æ¡ˆä¾‹ï¼‰</a> <code>143+</code> èµ ğŸ‘</li>
</ul>
<p><strong>å¼€æºé¡¹ç›®ç³»åˆ—</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/6922340460136513549" title="https://juejin.cn/post/6922340460136513549">ã€Œreact ç¼“å­˜é¡µé¢ã€ä»éœ€æ±‚åˆ°å¼€æºï¼ˆæˆ‘æ˜¯æ€ä¹ˆæ ·è®©äº§å“å°å§å§åˆ®ç›®ç›¸çœ‹çš„ï¼‰</a> <code>300+</code> èµ ğŸ‘</li>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/6919308174151385096" title="https://juejin.cn/post/6919308174151385096">ã€Œå‰ç«¯å·¥ç¨‹åŒ–ã€ä» 0-1 æ­å»º reactï¼Œts è„šæ‰‹æ¶ï¼ˆ1.2w å­—è¶…è¯¦ç»†æ•™ç¨‹ï¼‰</a> <code>330+</code> èµ ğŸ‘</li>
</ul>
<h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p><a target="_blank" rel="noopener" href="https://reactjs.org/" title="https://reactjs.org/">react ä¸­æ–‡æ–‡æ¡£</a></p>

<div class="article-footer fs14">
    <section id="license">
      <div class="header"><span>è®¸å¯åè®®</span></div>
      <div class="body"><p>æœ¬æ–‡é‡‡ç”¨ <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…</a> è®¸å¯åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
</div>
    </section>
    
    <section id="share">
      <div class="header"><span>åˆ†äº«æ–‡ç« </span></div>
      <div class="body">
        <div class="link"><input class="copy-area" readonly="true" id="copy-link" value="https://panzhenjie.fun/2024/02/28/[React%E8%BF%9B%E9%98%B6]API%E5%85%A8%E9%9D%A2%E8%A7%A3%E8%AF%BB%E4%B8%8E%E5%9F%BA%E7%A1%80%E5%AE%9E%E8%B7%B5/" /></div>
        <div class="social-wrap dis-select"><a class="social share-item wechat" onclick="util.toggle(&quot;qrcode-wechat&quot)"><img  referrerpolicy="no-referrer" class="lazy"  src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/b32ef3da1162a.svg" /></a><a class="social share-item weibo" target="_blank" rel="external nofollow noopener noreferrer" href="https://service.weibo.com/share/share.php?url=https://panzhenjie.fun/2024/02/28/[React%E8%BF%9B%E9%98%B6]API%E5%85%A8%E9%9D%A2%E8%A7%A3%E8%AF%BB%E4%B8%8E%E5%9F%BA%E7%A1%80%E5%AE%9E%E8%B7%B5/&title=[Reactè¿›é˜¶]APIå…¨é¢è§£è¯»ä¸åŸºç¡€å®è·µ - JKKéšç¬”&summary=
åŸæ–‡åœ°å€ã€ŒReact è¿›é˜¶ã€ React å…¨éƒ¨ api è§£è¯»+åŸºç¡€å®è·µå¤§å…¨(å¤¯å®åŸºç¡€ 2 ä¸‡å­—æ€»ç»“) - æ˜é‡‘

å¾ˆå¤šåŒå­¦ç”¨reactå¼€å‘çš„æ—¶å€™ï¼ŒçœŸæ­£ç”¨åˆ°çš„Reactçš„apiå°‘ä¹‹åˆå°‘ï¼ŒåŸºæœ¬åœç•™åœ¨Component,React.mem..."><img  referrerpolicy="no-referrer" class="lazy"  src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/80c07e4dbb303.svg" /></a><a class="social share-item email" href="mailto:?subject=[Reactè¿›é˜¶]APIå…¨é¢è§£è¯»ä¸åŸºç¡€å®è·µ - JKKéšç¬”&amp;body=https://panzhenjie.fun/2024/02/28/[React%E8%BF%9B%E9%98%B6]API%E5%85%A8%E9%9D%A2%E8%A7%A3%E8%AF%BB%E4%B8%8E%E5%9F%BA%E7%A1%80%E5%AE%9E%E8%B7%B5/"><img  referrerpolicy="no-referrer" class="lazy"  src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/a1b00e20f425d.svg" /></a><a class="social share-item link" onclick="util.copy(&quot;copy-link&quot;, &quot;å¤åˆ¶æˆåŠŸ&quot;)"><img  referrerpolicy="no-referrer" class="lazy"  src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/8411ed322ced6.svg" /></a></div>
        
        <div class="qrcode" id="qrcode-wechat" style="opacity:0;height:0">
          <img  referrerpolicy="no-referrer" class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://api.qrserver.com/v1/create-qr-code/?size=256x256&data=https://panzhenjie.fun/2024/02/28/[React%E8%BF%9B%E9%98%B6]API%E5%85%A8%E9%9D%A2%E8%A7%A3%E8%AF%BB%E4%B8%8E%E5%9F%BA%E7%A1%80%E5%AE%9E%E8%B7%B5/"/>
        </div>
        
      </div>
    </section>
    </div>
</article>
<div class="related-wrap" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">è¾ƒæ–°æ–‡ç« </div><a href="/2024/02/28/2023%E5%86%8D%E7%9C%8BReact%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%BA%93/">2023å†çœ‹ReactçŠ¶æ€ç®¡ç†åº“</a></div><div class="item" id="next"><div class="note">è¾ƒæ—©æ–‡ç« </div><a href="/2024/02/26/Linux%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/">LinuxåŸºç¡€æ•™ç¨‹</a></div></section></div>

<div class="related-wrap" id="related-posts">
    <section class='header'>
      <div class='title cap theme'>æ‚¨å¯èƒ½æ„Ÿå…´è¶£çš„æ–‡ç« </div>
    </section>
    <section class='body'>
    <div class="related-posts"><a class="item" href="\2024\02\28\2023å†çœ‹ReactçŠ¶æ€ç®¡ç†åº“\" title="2023å†çœ‹ReactçŠ¶æ€ç®¡ç†åº“"><span class="title">2023å†çœ‹ReactçŠ¶æ€ç®¡ç†åº“</span></a><a class="item" href="\2024\07\31\ä¸€æ–‡åƒé€-React-SSR-æœåŠ¡ç«¯æ¸²æŸ“å’ŒåŒæ„åŸç†\" title="ä¸€æ–‡åƒé€ React SSR æœåŠ¡ç«¯æ¸²æŸ“å’ŒåŒæ„åŸç†"><span class="title">ä¸€æ–‡åƒé€ React SSR æœåŠ¡ç«¯æ¸²æŸ“å’ŒåŒæ„åŸç†</span></a></div></section></div>


  <div class="related-wrap md-text" id="comments">
    <section class='header cmt-title cap theme'>
      <p>å¿«æ¥å‚ä¸è®¨è®ºå§~</p>

    </section>
    <section class='body cmt-body utterances'>
      

<svg class="loading" style="vertical-align:middle;fill:currentColor;overflow:hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2709"><path d="M832 512c0-176-144-320-320-320V128c211.2 0 384 172.8 384 384h-64zM192 512c0 176 144 320 320 320v64C300.8 896 128 723.2 128 512h64z" p-id="2710"></path></svg>

<div id="utterances" repo="stephenykk/discussion" issue-term="pathname" theme="preferred-color-scheme"></div>

    </section>
  </div>



<footer class="page-footer footnote"><hr><div class="text"><p>æœ¬ç«™ç”± <a href="/">stephenykk</a> ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.27.0">Stellar 1.27.0</a> ä¸»é¢˜åˆ›å»ºã€‚<br>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
</div></footer>
<div class="main-mask" onclick="sidebar.dismiss()"></div></div><aside class="l_right">
<div class="widgets">



<widget class="widget-wrapper toc" id="data-toc" collapse="false"><div class="widget-header dis-select"><span class="name">æœ¬æ–‡ç›®å½•</span><a class="cap-action" onclick="sidebar.toggleTOC()" ><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg></a></div><div class="widget-body"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E7%B1%BB"><span class="toc-text">ç»„ä»¶ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Component"><span class="toc-text">Component</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PureComponent"><span class="toc-text">PureComponent</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#memo"><span class="toc-text">memo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#forwardRef"><span class="toc-text">forwardRef</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lazy"><span class="toc-text">lazy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Suspense"><span class="toc-text">Suspense</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fragment"><span class="toc-text">Fragment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Profiler"><span class="toc-text">Profiler</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#StrictMode"><span class="toc-text">StrictMode</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="toc-text">å·¥å…·ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#createElement"><span class="toc-text">createElement</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cloneElement"><span class="toc-text">cloneElement</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#createContext"><span class="toc-text">createContext</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#createFactory"><span class="toc-text">createFactory</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#createRef"><span class="toc-text">createRef</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#isValidElement"><span class="toc-text">isValidElement</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Children-map"><span class="toc-text">Children.map</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Children-forEach"><span class="toc-text">Children.forEach</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Children-count"><span class="toc-text">Children.count</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Children-toArray"><span class="toc-text">Children.toArray</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Children-only"><span class="toc-text">Children.only</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#react-hooks"><span class="toc-text">react-hooks</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#useState"><span class="toc-text">useState</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#useEffect"><span class="toc-text">useEffect</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#useMemo"><span class="toc-text">useMemo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#useCallback"><span class="toc-text">useCallback</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#useRef"><span class="toc-text">useRef</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#useLayoutEffect"><span class="toc-text">useLayoutEffect</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#useReducer"><span class="toc-text">useReducer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#useContext"><span class="toc-text">useContext</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#useImperativeHandle"><span class="toc-text">useImperativeHandle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#useDebugValue"><span class="toc-text">useDebugValue</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#useTransition"><span class="toc-text">useTransition</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#react-dom"><span class="toc-text">react-dom</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#render"><span class="toc-text">render</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hydrate"><span class="toc-text">hydrate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#createPortal"><span class="toc-text">createPortal</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#unstable-batchedUpdates"><span class="toc-text">unstable_batchedUpdates</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flushSync"><span class="toc-text">flushSync</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#findDOMNode"><span class="toc-text">findDOMNode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#unmountComponentAtNode"><span class="toc-text">unmountComponentAtNode</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">æ€»ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%80%E6%9C%9F-react-%E6%96%87%E7%AB%A0"><span class="toc-text">å¾€æœŸ react æ–‡ç« </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3"><span class="toc-text">å‚è€ƒæ–‡æ¡£</span></a></li></ol></li></ol></div><div class="widget-footer">

<a class="top" onclick="util.scrollTop()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 12c0-4.714 0-7.071 1.464-8.536C4.93 2 7.286 2 12 2c4.714 0 7.071 0 8.535 1.464C22 4.93 22 7.286 22 12c0 4.714 0 7.071-1.465 8.535C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.465C2 19.072 2 16.714 2 12Z"/><path stroke-linecap="round" stroke-linejoin="round" d="m9 15.5l3-3l3 3m-6-4l3-3l3 3"/></g></svg><span>å›åˆ°é¡¶éƒ¨</span></a></div></widget>
</div></aside><div class='float-panel blur'>
  <button type='button' style='display:none' class='laptop-only rightbar-toggle mobile' onclick='sidebar.rightbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg>
  </button>
  <button type='button' style='display:none' class='mobile-only leftbar-toggle mobile' onclick='sidebar.leftbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 11c0-3.771 0-5.657 1.172-6.828C4.343 3 6.229 3 10 3h4c3.771 0 5.657 0 6.828 1.172C22 5.343 22 7.229 22 11v2c0 3.771 0 5.657-1.172 6.828C19.657 21 17.771 21 14 21h-4c-3.771 0-5.657 0-6.828-1.172C2 18.657 2 16.771 2 13z"/><path id="sep" stroke-linecap="round" d="M5.5 10h6m-5 4h4m4.5 7V3"/></g></svg>
  </button>
</div>
</div><div class="scripts">
<script type="text/javascript">
  const ctx = {
    date_suffix: {
      just: `åˆšåˆš`,
      min: `åˆ†é’Ÿå‰`,
      hour: `å°æ—¶å‰`,
      day: `å¤©å‰`,
    },
    root : `/`,
  };

  // required plugins (only load if needs)
  if (`local_search`) {
    ctx.search = {};
    ctx.search.service = `local_search`;
    if (ctx.search.service == 'local_search') {
      let service_obj = Object.assign({}, `{"field":"all","path":"/search.json","content":true,"sort":"-date"}`);
      ctx.search[ctx.search.service] = service_obj;
    }
  }
  const def = {
    avatar: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/3442075.svg`,
    cover: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/cover/76b86c0226ffd.svg`,
  };
  const deps = {
    jquery: `https://cdn.bootcdn.net/ajax/libs/jquery/3.7.1/jquery.min.js`,
    marked: `https://cdn.bootcdn.net/ajax/libs/marked/4.0.18/marked.min.js`
  }
  

</script>

<script type="text/javascript">
  const utils = {
    // æ‡’åŠ è½½ css https://github.com/filamentgroup/loadCSS
    css: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    js: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      if (src.startsWith('/')){
        src = ctx.root + src.substring(1);
      }
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // é»˜è®¤å¼‚æ­¥ï¼Œå¦‚æœéœ€è¦åŒæ­¥ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ {} å³å¯
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    jq: (fn) => {
      if (typeof jQuery === 'undefined') {
        utils.js(deps.jquery).then(fn)
      } else {
        fn()
      }
    },
    
    onLoading: (el) => {
      if (el) {
        $(el).append('<div class="loading-wrap"><svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" stroke-opacity=".3" d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="1.3s" values="60;0"/></path><path stroke-dasharray="15" stroke-dashoffset="15" d="M12 3C16.9706 3 21 7.02944 21 12"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.3s" values="15;0"/><animateTransform attributeName="transform" dur="1.5s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12"/></path></g></svg></div>');
      }
    },
    onLoadSuccess: (el) => {
      if (el) {
        $(el).find('.loading-wrap').remove();
      }
    },
    onLoadFailure: (el) => {
      if (el) {
        $(el).find('.loading-wrap svg').remove();
        $(el).find('.loading-wrap').append('<svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" d="M12 3L21 20H3L12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.5s" values="60;0"/></path><path stroke-dasharray="6" stroke-dashoffset="6" d="M12 10V14"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="6;0"/></path></g><circle cx="12" cy="17" r="1" fill="currentColor" fill-opacity="0"><animate fill="freeze" attributeName="fill-opacity" begin="0.8s" dur="0.4s" values="0;1"/></circle></svg>');
        $(el).find('.loading-wrap').addClass('error');
      }
    },
    request: (el, url, callback, onFailure) => {
      let retryTimes = 3;
      utils.onLoading(el);
      function req() {
        return new Promise((resolve, reject) => {
          let status = 0; // 0 ç­‰å¾… 1 å®Œæˆ 2 è¶…æ—¶
          let timer = setTimeout(() => {
            if (status === 0) {
              status = 2;
              timer = null;
              reject('è¯·æ±‚è¶…æ—¶');
              if (retryTimes == 0) {
                onFailure();
              }
            }
          }, 5000);
          fetch(url).then(function(response) {
            if (status !== 2) {
              clearTimeout(timer);
              resolve(response);
              timer = null;
              status = 1;
            }
            if (response.ok) {
              return response.json();
            }
            throw new Error('Network response was not ok.');
          }).then(function(data) {
            retryTimes = 0;
            utils.onLoadSuccess(el);
            callback(data);
          }).catch(function(error) {
            if (retryTimes > 0) {
              retryTimes -= 1;
              setTimeout(() => {
                req();
              }, 5000);
            } else {
              utils.onLoadFailure(el);
              onFailure();
            }
          });
        });
      }
      req();
    },
  };
</script>

<script>
  const sidebar = {
    leftbar: () => {
      if (l_body) {
        l_body.toggleAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    rightbar: () => {
      if (l_body) {
        l_body.toggleAttribute('rightbar');
        l_body.removeAttribute('leftbar');
      }
    },
    dismiss: () => {
      if (l_body) {
        l_body.removeAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    toggleTOC: () => {
      document.querySelector('#data-toc').classList.toggle('collapse');
    }
  }
</script>

<!-- required -->
<script src="/js/main.js?v=1.27.0" async></script>

<!-- optional -->

  <script>
  function loadUtterances() {
    const els = document.querySelectorAll("#comments #utterances");
    if (els.length === 0) return;
    els.forEach((el, i) => {
      try {
        el.innerHTML = '';
      } catch (error) {
        console.error(error);
      }
      var script = document.createElement('script');
      script.src = 'https://utteranc.es/client.js';
      script.async = true;
      for (let key of Object.keys(el.attributes)) {
        let attr = el.attributes[key];
        if (['class', 'id'].includes(attr.name) === false) {
          script.setAttribute(attr.name, attr.value);
        }
      }
      el.appendChild(script);
    });
  }
  window.addEventListener('DOMContentLoaded', (event) => {
      loadUtterances();
  });
</script>




<script defer>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.services = Object.assign({}, JSON.parse(`{"mdrender":{"js":"/js/services/mdrender.js"},"siteinfo":{"js":"/js/services/siteinfo.js","api":null},"ghinfo":{"js":"/js/services/ghinfo.js"},"sites":{"js":"/js/services/sites.js"},"friends":{"js":"/js/services/friends.js"},"timeline":{"js":"/js/services/timeline.js"},"fcircle":{"js":"/js/services/fcircle.js"},"weibo":{"js":"/js/services/weibo.js"},"memos":{"js":"/js/services/memos.js"}}`));
    for (let id of Object.keys(ctx.services)) {
      const js = ctx.services[id].js;
      if (id == 'siteinfo') {
        ctx.cardlinks = document.querySelectorAll('a.link-card[cardlink]');
        if (ctx.cardlinks?.length > 0) {
          utils.js(js, { defer: true }).then(function () {
            setCardLink(ctx.cardlinks);
          });
        }
      } else {
        const els = document.getElementsByClassName(`ds-${id}`);
        if (els?.length > 0) {
          utils.jq(() => {
            if (id == 'timeline' || 'memos' || 'marked') {
              utils.js(deps.marked).then(function () {
                utils.js(js, { defer: true });
              });
            } else {
              utils.js(js, { defer: true });
            }
          });
        }
      }
    }
  });
</script>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.search = {
      path: `/search.json`,
    }
    utils.js('/js/search/local-search.js', { defer: true });
  });
</script><script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?527d24f1a4c0bef6256d4231fa3c74ac";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<script>
  window.FPConfig = {
    delay: 0,
    ignoreKeywords: [],
    maxRPS: 5,
    hoverDelay: 25
  };
</script>
<script defer src="https://cdn.bootcdn.net/ajax/libs/flying-pages/2.1.2/flying-pages.min.js"></script><script defer src="https://cdn.bootcdn.net/ajax/libs/vanilla-lazyload/17.8.4/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazy",
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    window.lazyLoadInstance?.update();
  });
</script><script>
  ctx.fancybox = {
    selector: `.timenode p>img`,
    css: `https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.22/fancybox/fancybox.min.css`,
    js: `https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.22/fancybox/fancybox.umd.min.js`
  };
  var selector = '[data-fancybox]:not(.error)';
  if (ctx.fancybox.selector) {
    selector += `, ${ctx.fancybox.selector}`
  }
  var needFancybox = document.querySelectorAll(selector).length !== 0;
  if (!needFancybox) {
    const els = document.getElementsByClassName('ds-memos');
    if (els != undefined && els.length > 0) {
      needFancybox = true;
    }
  }
  if (needFancybox) {
    utils.css(ctx.fancybox.css);
    utils.js(ctx.fancybox.js, { defer: true }).then(function () {
      Fancybox.bind(selector, {
        hideScrollbar: false,
        Thumbs: {
          autoStart: false,
        },
        caption: (fancybox, slide) => {
          return slide.triggerEl.alt || null
        }
      });
    })
  }
</script><script>
  window.addEventListener('DOMContentLoaded', (event) => {
    const swiper_api = document.getElementById('swiper-api');
    if (swiper_api != undefined) {
      utils.css(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.css`);
      utils.js(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.js`, { defer: true }).then(function () {
        const effect = swiper_api.getAttribute('effect') || '';
        var swiper = new Swiper('.swiper#swiper-api', {
          slidesPerView: 'auto',
          spaceBetween: 8,
          centeredSlides: true,
          effect: effect,
          loop: true,
          pagination: {
            el: '.swiper-pagination',
            clickable: true,
          },
          navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
          },
        });
      })
    }
  });
</script><script>
  document.addEventListener('DOMContentLoaded', function () {
    window.codeElements = document.querySelectorAll('.code');
    if (window.codeElements.length > 0) {
      ctx.copycode = {
        default_text: `Copy`,
        success_text: `Copied`,
        toast: `å¤åˆ¶æˆåŠŸ`,
      };
      utils.js('/js/plugins/copycode.js');
    }
  });
</script>


<!-- inject -->

</div></body></html>
